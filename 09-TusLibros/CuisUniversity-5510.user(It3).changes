

----QUIT----(26 October 2022 08:07:27) CuisUniversity-5510.image priorSource: 2900072!

----STARTUP---- (26 October 2022 08:07:28) as /Users/hernan/Documents/Cuis/5.0-64Bits/Cuis-University-Installer/CuisUniversity-5510.image!


----QUIT----(26 October 2022 08:07:28) CuisUniversity-5510.image priorSource: 7154921!

----STARTUP---- (3 November 2022 17:35:39) as /home/clinux01/Descargas/linux64/CuisUniversity-5510.image!


----End fileIn of /home/clinux01/Descargas/Iteracion2/TusLibros-33.st----!

Object subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCardTest category: 'TusLibros' stamp: 'Simon 11/3/2022 19:26:17'!
Object subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCardTest methodsFor: 'no messages' stamp: 'Simon 11/3/2022 19:27:39'!
test01CannotCreateCreditCartWithInvalidNumer
	self should: [CreditCard with: 1 of: 'Pepe' thatExpiresIn: self validExpirationDate.]
	 raise:  Error  withMessageText: CreditCard invalidOwnerErrorDescription.! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'Simon 11/3/2022 19:28:15'!
expiredDate

	^ Month month: today monthIndex year: today yearNumber - 1! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'Simon 11/3/2022 19:28:15' prior: 50555794!
expiredCreditCard
	
	^CreditCard expiringOn: (self expiredDate)! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'Simon 11/3/2022 19:28:19' prior: 50555838!
expiredCreditCard
	
	^CreditCard expiringOn: self expiredDate! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'Simon 11/3/2022 19:28:37'!
expirationDate

	^ Month month: today monthIndex year: today yearNumber - 1! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'Simon 11/3/2022 19:28:37' prior: 50555844!
expiredCreditCard
	
	^CreditCard expiringOn: self expirationDate! !

!methodRemoval: StoreTestObjectsFactory #expiredDate stamp: 'Simon 11/3/2022 19:28:37'!
expiredDate

	^ Month month: today monthIndex year: today yearNumber - 1!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'Simon 11/3/2022 19:28:59'!
notExpiredDate

	^ Month month: today monthIndex year: today yearNumber + 1! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'Simon 11/3/2022 19:28:59' prior: 50555787!
notExpiredCreditCard
	
	^CreditCard expiringOn: (self notExpiredDate)! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'Simon 11/3/2022 19:29:05' prior: 50555871!
notExpiredCreditCard
	
	^CreditCard expiringOn: self notExpiredDate! !

!classDefinition: #CreditCardTest category: 'TusLibros' stamp: 'Simon 11/3/2022 19:30:04'!
Object subclass: #CreditCardTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCardTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:30:02'!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.! !
!CreditCardTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:30:33' prior: 50555822!
test01CannotCreateCreditCartWithInvalidNumer
	self should: [CreditCard with: 1 of: 'Pepe' thatExpiresIn: testObjectsFactory expiredDate.]
	 raise:  Error  withMessageText: CreditCard invalidOwnerErrorDescription.! !
!CreditCardTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:30:52' prior: 50555894!
test01CannotCreateCreditCartWithInvalidNumer
	self should: [CreditCard with: 1 of: 'Pepe' thatExpiresIn: testObjectsFactory expirationDate.]
	 raise:  Error  withMessageText: CreditCard invalidOwnerErrorDescription.! !
!CreditCardTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:31:00' prior: 50555904!
test01CannotCreateCreditCartWithInvalidNumer
	self should: [CreditCard with: 14 of: 'Pepe' thatExpiresIn: testObjectsFactory expirationDate.]
	 raise:  Error  withMessageText: CreditCard invalidOwnerErrorDescription.! !
!CreditCardTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:31:39' prior: 50555914!
test01CannotCreateCreditCartWithInvalidNumer
	self should: [CreditCard with: 14 of: 'Pepe' thatExpiresIn: testObjectsFactory expirationDate.]
	 raise:  Error  withMessageText: CreditCard invalidNumberErrorDescription.! !

TestCase subclass: #CreditCardTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCardTest category: 'TusLibros' stamp: 'Simon 11/3/2022 19:31:54'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 19:31:56'!
ERROR!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 19:31:56'!
ERROR!
!CreditCard class methodsFor: 'errors' stamp: 'Simon 11/3/2022 19:32:10'!
invalidNumberErrorDescription
	self shouldBeImplemented.! !
!CreditCard class methodsFor: 'errors' stamp: 'Simon 11/3/2022 19:32:51' prior: 50555953!
invalidNumberErrorDescription
	^'Credit card can only be created with a positive 16 digit number.'! !

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 19:32:54'!
FAILURE!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 19:33:38'!
FAILURE!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 19:33:38'!
FAILURE!
!CreditCard class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 19:35:20'!
with: cardNumber of: cardOwner thatExpireson: expirationDate
	^self new initializeWith: cardNumber of: cardOwner thatExpireson: expirationDate.! !
!CreditCardTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:35:36' prior: 50555924!
test01CannotCreateCreditCartWithInvalidNumer
	self should: [CreditCard with: 14 of: 'Pepe' thatExpiresOn: testObjectsFactory expirationDate.]
	 raise:  Error  withMessageText: CreditCard invalidNumberErrorDescription.! !

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 19:35:38'!
FAILURE!
!CreditCard methodsFor: 'initialization' stamp: 'Simon 11/3/2022 19:36:38'!
initializeWith: cardNumber of: cardOwner thatExpireson: expirationDate
	! !

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'Simon 11/3/2022 19:37:13'!
Object subclass: #CreditCard
	instanceVariableNames: 'expiration number'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'Simon 11/3/2022 19:37:14'!
Object subclass: #CreditCard
	instanceVariableNames: 'expiration number owner'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCard methodsFor: 'initialization' stamp: 'Simon 11/3/2022 19:37:10' prior: 50555996!
initializeWith: cardNumber of: cardOwner thatExpireson: expirationDate
	
	expiration := expirationDate.
	number := cardNumber.
	owner := cardOwner! !
!CreditCard class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 19:37:42' prior: 50555975!
with: cardNumber of: cardOwner thatExpireson: expirationDate
	
	
	
	^self new initializeWith: cardNumber of: cardOwner thatExpireson: expirationDate.
	! !
!CreditCard class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 19:39:21' prior: 50556024!
with: cardNumber of: cardOwner thatExpireson: expirationDate
	
	(cardNumber asString size == 16 & cardNumber > 0 ) ifTrue: [].
	
	^self new initializeWith: cardNumber of: cardOwner thatExpireson: expirationDate.
	! !
!CreditCard class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 19:40:51' prior: 50556032!
with: cardNumber of: cardOwner thatExpireson: expirationDate
	
	((cardNumber asString size == 16) and: [cardNumber > 0]) ifFalse: [self invalidNumberErrorDescription].
	
	^self new initializeWith: cardNumber of: cardOwner thatExpireson: expirationDate.
	
	! !
!CreditCard class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 19:41:05'!
assertNumberIsValid: cardNumber

	^ ((cardNumber asString size == 16) and: [cardNumber > 0]) ifFalse: [self invalidNumberErrorDescription]! !
!CreditCard class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 19:41:05' prior: 50556042!
with: cardNumber of: cardOwner thatExpireson: expirationDate
	
	self assertNumberIsValid: cardNumber.
	
	^self new initializeWith: cardNumber of: cardOwner thatExpireson: expirationDate.
	
	! !

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 19:41:19'!
FAILURE!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 19:41:19'!
FAILURE!
!CreditCard class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 19:42:17'!
with: cardNumber of: cardOwner thatExpiresOn: expirationDate
	
	self assertNumberIsValid: cardNumber.
	
	^self new initializeWith: cardNumber of: cardOwner thatExpireson: expirationDate.
	
	! !

!methodRemoval: CreditCard class #with:of:thatExpireson: stamp: 'Simon 11/3/2022 19:42:17'!
with: cardNumber of: cardOwner thatExpireson: expirationDate
	
	self assertNumberIsValid: cardNumber.
	
	^self new initializeWith: cardNumber of: cardOwner thatExpireson: expirationDate.
	
	!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 19:42:22'!
FAILURE!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 19:42:22'!
FAILURE!
!CreditCard class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 19:43:06' prior: 50556053!
assertNumberIsValid: cardNumber

	^ ((cardNumber asString size == 16) and: [cardNumber > 0]) ifFalse: [^self error: self invalidNumberErrorDescription]! !

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 19:43:09'!
PASSED!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 19:43:11'!
PASSED!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 19:43:11'!
PASSED!
!CreditCardTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:44:04' prior: 50555983!
test01CannotCreateCreditCartWithInvalidNumer
	self should: [CreditCard with: '14' of: 'Pepe' thatExpiresOn: testObjectsFactory expirationDate.]
	 raise:  Error  withMessageText: CreditCard invalidNumberErrorDescription.! !
!CreditCard class methodsFor: 'asserts' stamp: 'Simon 11/3/2022 19:44:58' prior: 50556104!
assertNumberIsValid: cardNumber

	^ ((cardNumber size == 16) and: [cardNumber asNumber > 0]) ifFalse: [^self error: self invalidNumberErrorDescription]! !
!CreditCard class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 19:45:58' prior: 50556078!
with: cardNumber of: cardOwner thatExpiresOn: expirationDate
	
	self assertNumberIsValid: cardNumber.
	
	^self new initializeWith: cardNumber asNumber of: cardOwner thatExpireson: expirationDate.
	
	! !
!CreditCard class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 19:46:05' prior: 50556141!
with: stringCardNumber of: cardOwner thatExpiresOn: expirationDate
	
	self assertNumberIsValid: stringCardNumber.
	
	^self new initializeWith: stringCardNumber asNumber of: cardOwner thatExpireson: expirationDate.
	
	! !
!CreditCardTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:46:29' prior: 50556123!
test01CannotCreateCreditCartWithInvalidNumer
	
	self should: [CreditCard with: '14' of: 'Pepe' thatExpiresOn: testObjectsFactory expirationDate.]
	 raise:  Error  withMessageText: CreditCard invalidNumberErrorDescription.! !
!CreditCardTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:47:29'!
test02CannotCreateCreditCartWithInvalidOwner
	
	self should: [CreditCard with: '14' of: '     ' thatExpiresOn: testObjectsFactory expirationDate.]
	 raise:  Error  withMessageText: CreditCard invalidNumberErrorDescription.
	! !
!CreditCard class methodsFor: 'errors' stamp: 'Simon 11/3/2022 19:48:06'!
invalidOwnerErrorDescription
	^'Owner name cannot be empty'.! !
!CreditCard class methodsFor: 'asserts' stamp: 'Simon 11/3/2022 19:49:02'!
assertOwnerIsValid: cardOwner

	^ (cardOwner isLastSeparator) ifFalse: [^self error: self invalidOwnerErrorDescription]! !
!CreditCard class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 19:49:25' prior: 50556151!
with: stringCardNumber of: cardOwner thatExpiresOn: expirationDate
	
	self assertNumberIsValid: stringCardNumber.
	self assertOwnerIsValid: cardOwner.
	
	^self new initializeWith: stringCardNumber asNumber of: cardOwner thatExpireson: expirationDate.
	
	! !
!CreditCard class methodsFor: 'asserts' stamp: 'Simon 11/3/2022 19:50:19' prior: 50556186!
assertOwnerIsValid: cardOwner

	^((cardOwner isEmpty) or:[cardOwner isLastSeparator]) ifFalse: [^self error: self invalidOwnerErrorDescription]! !
!CreditCardTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:50:31' prior: 50556171!
test02CannotCreateCreditCartWithInvalidOwner
	
	self should: [CreditCard with: '14' of: '     ' thatExpiresOn: testObjectsFactory expirationDate.]
	 raise:  Error  withMessageText: CreditCard invalidOwnerErrorDescription.
	! !

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/3/2022 19:50:32'!
FAILURE!
!CreditCardTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:50:54' prior: 50556212!
test02CannotCreateCreditCartWithInvalidOwner
	
	self should: [CreditCard with: '14' of: '     ' thatExpiresOn: testObjectsFactory expirationDate.]
	 raise:  Error - MessageNotUnderstood  withMessageText: CreditCard invalidOwnerErrorDescription.
	! !

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/3/2022 19:50:55'!
FAILURE!

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/3/2022 19:51:07'!
FAILURE!

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/3/2022 19:51:38'!
FAILURE!
!CreditCardTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:52:23' prior: 50556226!
test02CannotCreateCreditCartWithInvalidOwner
	
	self should: [CreditCard with: '0123456789101112' of: '     ' thatExpiresOn: testObjectsFactory expirationDate.]
	 raise:  Error - MessageNotUnderstood  withMessageText: CreditCard invalidOwnerErrorDescription.
	! !

0123456789101112!

'0123456789101112'!

self size!

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/3/2022 19:52:47'!
FAILURE!

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/3/2022 19:52:54'!
FAILURE!
!CreditCard class methodsFor: 'asserts' stamp: 'Simon 11/3/2022 19:53:21' prior: 50556204!
assertOwnerIsValid: cardOwner

	^((cardOwner isEmpty) or:[cardOwner isLastSeparator]) ifTrue: [^self error: self invalidOwnerErrorDescription]! !

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/3/2022 19:53:22'!
PASSED!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 19:53:22'!
PASSED!

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/3/2022 19:53:22'!
PASSED!

TestCase subclass: #RestInterfaceTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #RestInterfaceTest category: 'TusLibros' stamp: 'Simon 11/3/2022 19:54:43'!
TestCase subclass: #RestInterfaceTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!RestInterfaceTest methodsFor: 'no messages' stamp: 'Simon 11/3/2022 19:54:50' overrides: 16961394!
setUp
	! !

!classDefinition: #RestInterfaceTest category: 'TusLibros' stamp: 'Simon 11/3/2022 19:55:04'!
TestCase subclass: #RestInterfaceTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!RestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'Simon 11/3/2022 19:55:02' prior: 50556299 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'Simon 11/3/2022 19:58:57'!
Object subclass: #InternalRestInterface
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:58:36'!
test01NewCartIsListedEmpty
	| restInterface |
	restInterface := InternalRestInterface new.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:59:23' prior: 50556323!
test01NewCartIsListedEmpty

	! !

!classDefinition: #RestInterfaceTest category: 'TusLibros' stamp: 'Simon 11/3/2022 19:59:30'!
TestCase subclass: #RestInterfaceTest
	instanceVariableNames: 'testObjectsFactory restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 19:59:27' prior: 50556311 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface new.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:03:12' prior: 50556329!
test01NewCartIsListedEmpty

	| cartID cartId clientId password |
	cartId:= restInterface createCartFor: clientId with: password.
	
	self assert: restInterface listCart: cartID! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:03:58' prior: 50556349!
test01NewCartIsListedEmpty

	|  cartID clientId password |
	cartID:= restInterface createCartFor: clientId with: password.
	
	self assert: restInterface listCart: cartID! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:04:59' prior: 50556358!
test01NewCartIsListedEmpty

	|  cartID clientId password |
	clientId := 123.
	password := 'ContraInvalida'.
	cartID:= restInterface createCartFor: clientId with: password.
	
	self assert: restInterface listCart: cartID! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:07:02' prior: 50556342 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface withAuthenticator: self.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:07:06' prior: 50556378 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface withAuthenticator: self.
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:07:09' prior: 50556386 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface withAuthenticator: self.
	
	! !

!classDefinition: #RestInterfaceTest category: 'TusLibros' stamp: 'Simon 11/3/2022 20:07:49'!
TestCase subclass: #RestInterfaceTest
	instanceVariableNames: 'testObjectsFactory restInterface authenticationBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:07:47' prior: 50556394 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface withAuthenticator: self.
	
	authenticationBehavior := [].
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:08:10' prior: 50556411 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface withAuthenticator: self.
	
	authenticationBehavior := [:clientID :password | ].
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:09:00' prior: 50556367!
test01NewCartIsListedEmpty

	|  cartID clientId password |
	authenticationBehavior := [:c :p | false].
	clientId := 123.
	password := 'ContraInvalida'.
	cartID:= restInterface createCartFor: clientId with: password.
	
	self assert: restInterface listCart: cartID! !
!RestInterfaceTest methodsFor: 'authBehavior' stamp: 'Simon 11/3/2022 20:10:12'!
autenticateUser: clientID with: password
	^authenticationBehavior value: clientID value: password.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:11:15' prior: 50556429!
test01NewCartIsListedEmpty

	|  clientId password |
	authenticationBehavior := [:c :p | false].
	clientId := 123.
	password := 'ContraInvalida'.
	self should: [ restInterface createCartFor: clientId with: password.]
	raise: Error
	messageText: 	InternalRestInterface invalidLoginErrorDescription.! !
!InternalRestInterface class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 20:12:19'!
withAuthenticator: aRestInterfaceTest 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWithAuthenticator: aRestInterfaceTest ! !
!InternalRestInterface class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 20:13:07' prior: 50556459!
withAuthenticator: anAuthenticator 
	^self new initializeWithAuthenticator: anAuthenticator. ! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'Simon 11/3/2022 20:13:23'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/3/2022 20:13:23'!
initializeWithAuthenticator: anAuthenticator 
	self shouldBeImplemented.
	authenticator := anAuthenticator.! !
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/3/2022 20:13:29' prior: 50556483!
initializeWithAuthenticator: anAuthenticator 
	authenticator := anAuthenticator.! !

!testRun: #RestInterfaceTest #test01NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:13:31'!
ERROR!
!InternalRestInterface class methodsFor: 'errors' stamp: 'Simon 11/3/2022 20:13:39'!
invalidLoginErrorDescription
	self shouldBeImplemented.! !
!InternalRestInterface class methodsFor: 'errors' stamp: 'Simon 11/3/2022 20:14:06' prior: 50556499!
invalidLoginErrorDescription
	^'Invalid login, wrong clientID or password.'! !

!testRun: #RestInterfaceTest #test01NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:14:08'!
ERROR!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:14:28' prior: 50556446!
test01NewCartIsListedEmpty

	|  clientId password |
	authenticationBehavior := [:c :p | false].
	clientId := 123.
	password := 'ContraInvalida'.
	self should: [ restInterface createCartFor: clientId with: password.]
	raise: Error
	withMessageText: 	InternalRestInterface invalidLoginErrorDescription.! !

!testRun: #RestInterfaceTest #test01NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:14:30'!
FAILURE!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:14:45' prior: 50556513!
test01NewCartIsListedEmpty

	|  clientId password |
	authenticationBehavior := [:c :p | false].
	clientId := 123.
	password := 'ContraInvalida'.
	self should: [ restInterface createCartFor: clientId with: password.]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface invalidLoginErrorDescription.! !

!testRun: #RestInterfaceTest #test01NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:14:46'!
ERROR!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:15:21'!
createCartFor: clientId with: password 
	self shouldBeImplemented.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:15:44' prior: 50556545!
createCartFor: clientId with: password 
	authenticator autenticateUser: clientId with: password.! !

!testRun: #RestInterfaceTest #test01NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:15:47'!
FAILURE!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:16:39' prior: 50556551!
createCartFor: clientId with: password 
	(authenticator autenticateUser: clientId with: password) ifFalse: [self class invalidLoginErrorDescription ]! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:16:41' prior: 50556561!
createCartFor: clientId with: password 
	(authenticator autenticateUser: clientId with: password) ifFalse: [self class invalidLoginErrorDescription.]! !

!testRun: #RestInterfaceTest #test01NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:16:42'!
FAILURE!

authenticator autenticateUser: clientId with: password!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:17:06' prior: 50556569!
createCartFor: clientId with: password 
	(authenticator autenticateUser: clientId with: password) ifFalse: [self class invalidLoginErrorDescription.]! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:17:10' prior: 50556582!
createCartFor: clientId with: password 
	(authenticator autenticateUser: clientId with: password) ifFalse: [^self class invalidLoginErrorDescription.]! !

!testRun: #RestInterfaceTest #test01NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:17:13'!
FAILURE!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:17:34' prior: 50556590!
createCartFor: clientId with: password 
	(authenticator autenticateUser: clientId with: password) ifFalse: [^self error: self  class invalidLoginErrorDescription.]! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:17:35' prior: 50556601!
createCartFor: clientId with: password 
	(authenticator autenticateUser: clientId with: password) ifFalse: [^self error: self class invalidLoginErrorDescription.]! !

!testRun: #RestInterfaceTest #test01NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:17:36'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:17:36'!
PASSED!
!RestInterfaceTest methodsFor: 'authBehavior' stamp: 'Simon 11/3/2022 20:18:28'!
isAuthenticUser: clientID with: password
	^authenticationBehavior value: clientID value: password.! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/3/2022 20:18:28' prior: 50556610!
createCartFor: clientId with: password 
	(authenticator isAuthenticUser: clientId with: password) ifFalse: [^self error: self class invalidLoginErrorDescription.]! !

!methodRemoval: RestInterfaceTest #autenticateUser:with: stamp: 'Simon 11/3/2022 20:18:28'!
autenticateUser: clientID with: password
	^authenticationBehavior value: clientID value: password.!

!testRun: #RestInterfaceTest #test01NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:18:52'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:19:14' prior: 50556420 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface withAuthenticator: self.
	
	authenticationBehavior := [:clientID :password | true].
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:19:50'!
test01NewCartCannotBeCreatedWithInvalidLogin

	|  clientId password |
	authenticationBehavior := [:c :p | false].
	clientId := 123.
	password := 'ContraInvalida'.
	self should: [ restInterface createCartFor: clientId with: password.]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface invalidLoginErrorDescription.! !

!methodRemoval: RestInterfaceTest #test01NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:19:50'!
test01NewCartIsListedEmpty

	|  clientId password |
	authenticationBehavior := [:c :p | false].
	clientId := 123.
	password := 'ContraInvalida'.
	self should: [ restInterface createCartFor: clientId with: password.]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface invalidLoginErrorDescription.!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:21:59'!
test02NewCartIsListedEmpty

	|  clientId password cartID |
	clientId := 123.
	password := 'ContraInvalida'.
	
	cartID:= restInterface createCartFor: clientId with: password.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:22:08'!
ERROR!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:22:26' prior: 50556686!
test02NewCartIsListedEmpty

	|  clientId password cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !

!classDefinition: #RestInterfaceTest category: 'TusLibros' stamp: 'Simon 11/3/2022 20:23:11'!
TestCase subclass: #RestInterfaceTest
	instanceVariableNames: 'testObjectsFactory restInterface authenticationBehavior clientId1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #RestInterfaceTest category: 'TusLibros' stamp: 'Simon 11/3/2022 20:23:12'!
TestCase subclass: #RestInterfaceTest
	instanceVariableNames: 'testObjectsFactory restInterface authenticationBehavior clientId1 password1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:23:10' prior: 50556650 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface withAuthenticator: self.
	clientId1 := 1234.
	password1 := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := [:clientID :password | true].
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:23:18' prior: 50556659!
test01NewCartCannotBeCreatedWithInvalidLogin

	|  clientId password |
	authenticationBehavior := [:c :p | false].
	self should: [ restInterface createCartFor: clientId with: password.]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface invalidLoginErrorDescription.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:23:32' prior: 50556740!
test01NewCartCannotBeCreatedWithInvalidLogin

	authenticationBehavior := [:c :p | false].
	self should: [ restInterface createCartFor: clientId1 with: password1.]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface invalidLoginErrorDescription.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:23:39' prior: 50556700!
test02NewCartIsListedEmpty

	|  cartID |
	
	cartID:= restInterface createCartFor: clientId1 with: password1.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:23:41' prior: 50556765!
test02NewCartIsListedEmpty

	| cartID |
	
	cartID:= restInterface createCartFor: clientId1 with: password1.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !

!classDefinition: #RestInterfaceTest category: 'TusLibros' stamp: 'Simon 11/3/2022 20:23:46'!
TestCase subclass: #RestInterfaceTest
	instanceVariableNames: 'testObjectsFactory restInterface authenticationBehavior clientId password1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!RestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'Simon 11/3/2022 20:23:46' prior: 50556729 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface withAuthenticator: self.
	clientId := 1234.
	password1 := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := [:clientID :password | true].
	
	! !
!RestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'Simon 11/3/2022 20:23:46' prior: 50556753!
test01NewCartCannotBeCreatedWithInvalidLogin

	authenticationBehavior := [:c :p | false].
	self should: [ restInterface createCartFor: clientId with: password1.]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface invalidLoginErrorDescription.! !
!RestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'Simon 11/3/2022 20:23:46' prior: 50556774!
test02NewCartIsListedEmpty

	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password1.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !
!RestInterfaceTest methodsFor: 'authBehavior' stamp: 'Simon 11/3/2022 20:24:06' prior: 50556625!
isAuthenticUser: clientID with: clientPassword
	^authenticationBehavior value: clientID value: clientPassword.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:24:45' prior: 50556793 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface withAuthenticator: self.
	clientId := 1234.
	password1 := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := [:clientID :password | true].
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:24:56' prior: 50556833 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface withAuthenticator: self.
	clientId := 1234.
	password1 := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := [:clientID :clientPassword | true].
	
	! !

!classDefinition: #RestInterfaceTest category: 'TusLibros' stamp: 'Simon 11/3/2022 20:24:59'!
TestCase subclass: #RestInterfaceTest
	instanceVariableNames: 'testObjectsFactory restInterface authenticationBehavior clientId password'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!RestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'Simon 11/3/2022 20:24:59' prior: 50556845 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface withAuthenticator: self.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := [:clientID :clientPassword | true].
	
	! !
!RestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'Simon 11/3/2022 20:24:59' prior: 50556805!
test01NewCartCannotBeCreatedWithInvalidLogin

	authenticationBehavior := [:c :p | false].
	self should: [ restInterface createCartFor: clientId with: password.]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface invalidLoginErrorDescription.! !
!RestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'Simon 11/3/2022 20:24:59' prior: 50556817!
test02NewCartIsListedEmpty

	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:25:08'!
ERROR!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:25:15'!
listCart: cartID 
	self shouldBeImplemented.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:25:26' prior: 50556902!
listCart: cartID 
	^OrderedCollection new.! !

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:25:28'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 20:25:28'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:25:28'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:30:48' prior: 50556891!
test02NewCartIsListedEmpty

	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:32:55'!
test03CannotListInvalidCardId

	
	self assert: (restInterface listCart: 1) isEmpty.
	
	! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'Simon 11/3/2022 20:33:43'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/3/2022 20:33:41' prior: 50556490!
initializeWithAuthenticator: anAuthenticator 
	authenticator := anAuthenticator.
	lastID := 0.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:34:30' prior: 50556632!
createCartFor: clientId with: password 
	(authenticator isAuthenticUser: clientId with: password) ifFalse: [^self error: self class invalidLoginErrorDescription.].
	lastID := lastID+1.
	^lastID.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:35:22'!
checkValid: clientId with: password
	(authenticator isAuthenticUser: clientId with: password) ifFalse: [^self error: self class invalidLoginErrorDescription.].
	.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:35:32'!
assertValid: clientId with: password
	(authenticator isAuthenticUser: clientId with: password) ifFalse: [^self error: self class invalidLoginErrorDescription.].
	.! !

!methodRemoval: InternalRestInterface #checkValid:with: stamp: 'Simon 11/3/2022 20:35:32'!
checkValid: clientId with: password
	(authenticator isAuthenticUser: clientId with: password) ifFalse: [^self error: self class invalidLoginErrorDescription.].
	.!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:35:51' prior: 50556950!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	^lastID.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:36:34' prior: 50556867 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface withAuthenticator: self.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := [:clientID :clientPassword | true].
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:37:12' prior: 50556992 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface withAuthenticator: self.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := true.
	
	! !
!RestInterfaceTest methodsFor: 'authBehavior' stamp: 'Simon 11/3/2022 20:37:26' prior: 50556826!
isAuthenticUser: clientID with: clientPassword
	^authenticationBehavior.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:37:50' prior: 50556879!
test01NewCartCannotBeCreatedWithInvalidLogin

	authenticationBehavior :=false.
	self should: [ restInterface createCartFor: clientId with: password.]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface invalidLoginErrorDescription.! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 20:37:51'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 20:37:51'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:37:51'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCardId stamp: 'Simon 11/3/2022 20:37:51'!
PASSED!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:40:55' prior: 50556907!
listCart: cartID 
	(lastID <= cartID) ifTrue: [self class ]
	^OrderedCollection new.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:43:37' prior: 50556930!
test03CannotListInvalidCardId

	self should: [restInterface listCart: 1000]
	raise: Error
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:43:49' prior: 50557052!
test03CannotListInvalidCardId

	self should: [restInterface listCart: 1000]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !

!testRun: #RestInterfaceTest #test03CannotListInvalidCardId stamp: 'Simon 11/3/2022 20:43:50'!
ERROR!
!InternalRestInterface class methodsFor: 'errors' stamp: 'Simon 11/3/2022 20:43:56'!
invalidCartIDErrorDescription
	self shouldBeImplemented.! !
!InternalRestInterface class methodsFor: 'errors' stamp: 'Simon 11/3/2022 20:44:23' prior: 50557072!
invalidCartIDErrorDescription
	^'Invalid cart, please use a cart that was created. You can do it!!'! !

!testRun: #RestInterfaceTest #test03CannotListInvalidCardId stamp: 'Simon 11/3/2022 20:44:24'!
ERROR!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:44:57' prior: 50557046!
listCart: cartID 
	(lastID <= cartID) ifTrue: [self error: self class invalidCartIDErrorDescription].
	^OrderedCollection new.! !

!testRun: #RestInterfaceTest #test03CannotListInvalidCardId stamp: 'Simon 11/3/2022 20:45:01'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 20:45:01'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:45:01'!
ERROR!

!testRun: #RestInterfaceTest #test03CannotListInvalidCardId stamp: 'Simon 11/3/2022 20:45:01'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:45:01'!
ERROR!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:45:20'!
ERROR!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:45:20'!
ERROR!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:45:44' prior: 50557088!
listCart: cartID 
	(lastID <= cartID) ifFalse: [self error: self class invalidCartIDErrorDescription].
	^OrderedCollection new.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:45:50' prior: 50557118!
listCart: cartID 
	(lastID < cartID) ifFalse: [self error: self class invalidCartIDErrorDescription].
	^OrderedCollection new.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:45:57' prior: 50557126!
listCart: cartID 
	(lastID < cartID) ifTrue: [self error: self class invalidCartIDErrorDescription].
	^OrderedCollection new.! !

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:45:59'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 20:46:01'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:46:01'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCardId stamp: 'Simon 11/3/2022 20:46:01'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:46:40'!
test04ListInvalidCardWithOneBook

	self should: [restInterface listCart: 1000]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:47:13' prior: 50557153!
test04ListInvalidCardWithOneBook

	| cartID |
	cartID:= restInterface createCartFor: clientId with: password.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:47:29'!
test04ListCartWithOneBook

	| cartID |
	cartID:= restInterface createCartFor: clientId with: password.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !

!methodRemoval: RestInterfaceTest #test04ListInvalidCardWithOneBook stamp: 'Simon 11/3/2022 20:47:29'!
test04ListInvalidCardWithOneBook

	| cartID |
	cartID:= restInterface createCartFor: clientId with: password.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:47:44'!
test03CannotListInvalidCartID

	self should: [restInterface listCart: 1000]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !

!methodRemoval: RestInterfaceTest #test03CannotListInvalidCardId stamp: 'Simon 11/3/2022 20:47:44'!
test03CannotListInvalidCardId

	self should: [restInterface listCart: 1000]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:49:16' prior: 50557170!
test04ListCartWithOneBook

	| cartID isbn |
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:49:29' prior: 50557205!
test04ListCartWithOneBook

	| cartID isbn |
	isbn := 1.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !
!StoreTestObjectsFactory methodsFor: 'cart' stamp: 'Simon 11/3/2022 20:50:01' prior: 50555780!
defaultCatalog
	
	^ Dictionary new
		at: self itemSellByTheStore put: self itemSellByTheStorePrice;
		yourself ! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'Simon 11/3/2022 20:53:54' prior: 50555767!
itemSellByTheStore
	
	^ '43241'! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'Simon 11/3/2022 20:53:58' prior: 50557233!
itemSellByTheStore
	
	^ '1'! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'Simon 11/3/2022 20:54:02' prior: 50555762!
itemNotSellByTheStore
	
	^'2'! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'Simon 11/3/2022 20:54:07' prior: 50557242!
itemNotSellByTheStore
	
	^'24832958293'! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 20:54:13'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 20:54:13'!
ERROR!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 20:54:13'!
ERROR!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 20:54:22'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 20:54:22'!
ERROR!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 20:54:22'!
ERROR!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:54:33' prior: 50557215!
test04ListCartWithOneBook

	"| cartID isbn |
	isbn := 1.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	self assert: (restInterface listCart: cartID) isEmpty.
	"
	! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 20:54:35'!
PASSED!
!StoreTestObjectsFactory methodsFor: 'cart' stamp: 'Simon 11/3/2022 20:55:17' prior: 50557226!
defaultCatalog
	
	^ Dictionary new
		at: self itemSellByTheStore put: self itemSellByTheStorePrice;
		at: '1' put: 1;
		at: '2' put: 2;
		at: '3' put: 3;
		yourself ! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 20:55:41' prior: 50557392!
test04ListCartWithOneBook

	| cartID isbn |
	isbn := 1.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:57:05' prior: 50556984!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	^lastID.! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'Simon 11/3/2022 20:58:37'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID carts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'Simon 11/3/2022 20:58:43'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID carts defaultCatalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:58:33' prior: 50557490!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	carts at: clientId put: Cart acceptingItemsOf: defaultCatalog.
	^lastID.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 20:58:53' prior: 50557514!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	carts at: clientId put: (Cart acceptingItemsOf: defaultCatalog).
	^lastID.! !
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/3/2022 21:01:05'!
initializeWithAuthenticator: anAuthenticator andCatalog: catalog  
	authenticator := anAuthenticator.
	lastID := 0.! !
!InternalRestInterface class methodsFor: 'as yet unclassified' stamp: 'Simon 11/3/2022 21:01:05' prior: 50556469!
withAuthenticator: anAuthenticator 
	^self new initializeWithAuthenticator: anAuthenticator andCatalog: defaultCatalog. ! !

!methodRemoval: InternalRestInterface #initializeWithAuthenticator: stamp: 'Simon 11/3/2022 21:01:05'!
initializeWithAuthenticator: anAuthenticator 
	authenticator := anAuthenticator.
	lastID := 0.!
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/3/2022 21:01:20' prior: 50557532!
initializeWithAuthenticator: anAuthenticator andCatalog: catalog  
	authenticator := anAuthenticator.
	defaultCatalog := catalog.
	lastID := 0.! !
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/3/2022 21:01:45' prior: 50557554!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  
	authenticator := anAuthenticator.
	defaultCatalog := interfaceCatalog.
	lastID := 0.! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'Simon 11/3/2022 21:01:49'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID carts catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/3/2022 21:01:49' prior: 50557523!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	carts at: clientId put: (Cart acceptingItemsOf: catalog).
	^lastID.! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/3/2022 21:01:49' prior: 50557562!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	lastID := 0.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:02:21' prior: 50557004 overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	restInterface := InternalRestInterface withAuthenticator: self andCatalog: testObjectsFactory defaultCatalog.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := true.
	
	! !
!InternalRestInterface class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 21:03:10'!
withAuthenticator: anAuthenticator andCatalog: interfaceCatalog  
	^self new initializeWithAuthenticator: anAuthenticator andCatalog: defaultCatalog. ! !

!methodRemoval: InternalRestInterface class #withAuthenticator: stamp: 'Simon 11/3/2022 21:03:10'!
withAuthenticator: anAuthenticator 
	^self new initializeWithAuthenticator: anAuthenticator andCatalog: defaultCatalog. !
!InternalRestInterface class methodsFor: 'instance creation' stamp: 'Simon 11/3/2022 21:03:13' prior: 50557609!
withAuthenticator: anAuthenticator andCatalog: interfaceCatalog  
	^self new initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog. ! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:03:27' prior: 50557479!
test04ListCartWithOneBook

	"| cartID isbn |
	isbn := 1.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	self assert: (restInterface listCart: cartID) isEmpty."
	
	! !

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:03:27'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 21:03:27'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:03:27'!
ERROR!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 21:03:27'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:03:27'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:03:27'!
ERROR!
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/3/2022 21:03:55' prior: 50557588!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 21:03:57'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:03:58'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 21:03:58'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:03:58'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:04:03' prior: 50557633!
test04ListCartWithOneBook

	| cartID isbn |
	isbn := 1.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:04:04'!
ERROR!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 21:04:20'!
addToCart: cartID aBook: isbn times: aString 
	self shouldBeImplemented.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 21:09:29' prior: 50557699!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := carts at: cartID.
	cart add: quantity of: bookISBN.
	^'OK'.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 21:09:45' prior: 50557705!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := carts at: cartID.
	cart add: quantity of: bookISBN.
	carts at: cartID put: cart.
	^'OK'.! !

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:09:55'!
ERROR!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:10:19'!
ERROR!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 21:10:59' prior: 50557579!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	carts at: lastID put: (Cart acceptingItemsOf: catalog).
	^lastID.! !

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:11:01'!
ERROR!

catalog!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:11:38' prior: 50557686!
test04ListCartWithOneBook

	| cartID isbn |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:11:39'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 21:11:39'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:11:39'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 21:11:39'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:11:40'!
PASSED!

----SNAPSHOT----(3 November 2022 21:12:06) CuisUniversity-5510.image priorSource: 7155150!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:16:07' prior: 50557740!
test04ListCartWithOneBook

	| cartID isbn expectedList |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expectedList := Bag new; add: isbn.
	
	self assert: (restInterface listCart: cartID) equals:expectedList
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:16:12' prior: 50555253!
test04ListCartWithOneBook

	| cartID isbn expectedList |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expectedList := Bag new; add: isbn.
	
	self assert: (restInterface listCart: cartID) equals:expectedList.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:16:33' prior: 50555266!
test04ListCartWithOneBook

	| cartID isbn expectedList |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expectedList := Bag new; add: isbn; yourself.
	
	self assert: (restInterface listCart: cartID) equals:expectedList.
	
	! !

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:16:39'!
ERROR!

----STARTUP---- (3 November 2022 21:21:18) as /home/clinux01/Descargas/linux64/CuisUniversity-5510.image!


!classRemoval: #StoreTestObjectsFactory stamp: 'Simon 11/3/2022 21:21:38'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: 'today'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Sale stamp: 'Simon 11/3/2022 21:21:39'!
Object subclass: #Sale
	instanceVariableNames: 'total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #InternalRestInterface stamp: 'Simon 11/3/2022 21:21:39'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID carts catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCard stamp: 'Simon 11/3/2022 21:21:39'!
Object subclass: #CreditCard
	instanceVariableNames: 'expiration number owner'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'Simon 11/3/2022 21:21:39'!
Object subclass: #Cashier
	instanceVariableNames: 'cart salesBook merchantProcessor creditCard total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'Simon 11/3/2022 21:21:40'!
Object subclass: #Cart
	instanceVariableNames: 'catalog items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #RestInterfaceTest stamp: 'Simon 11/3/2022 21:21:40'!
TestCase subclass: #RestInterfaceTest
	instanceVariableNames: 'testObjectsFactory restInterface authenticationBehavior clientId password'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCardTest stamp: 'Simon 11/3/2022 21:21:40'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CashierTest stamp: 'Simon 11/3/2022 21:21:40'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'Simon 11/3/2022 21:21:41'!
TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /home/clinux01/Descargas/linux64/TusLibros.st----!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:23:06' prior: 50555637!
test04ListCartWithOneBook

	| cartID isbn expected |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expected _ Bag new; add: isbn; yourself .
	
	self assert: (restInterface listCart: cartID) isEmpty.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:23:31' prior: 50556028!
test04ListCartWithOneBook

	| cartID isbn expected |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expected _ Bag new; add: isbn; yourself .
	
	self assert: (restInterface listCart: cartID) equals: expected .
	
	! !

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:23:37'!
ERROR!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:24:09' prior: 50556041!
test04ListCartWithOneBook

	| cartID isbn expected |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expected _ Bag new.
	expected add: isbn.
	
	self assert: (restInterface listCart: cartID) equals: expected .
	
	! !

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:24:17'!
FAILURE!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 21:24:50' prior: 50555904!
listCart: cartID 
	(lastID < cartID) ifTrue: [self error: self class invalidCartIDErrorDescription].
	^Bag new.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 21:30:23' prior: 50556073!
listCart: cartID 
	(lastID < cartID) ifTrue: [self error: self class invalidCartIDErrorDescription].
	^carts at: cartID listItems.
	! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 21:31:07'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:31:07'!
ERROR!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 21:31:07'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:31:07'!
ERROR!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:31:12'!
ERROR!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 21:31:41' prior: 50556080!
listCart: cartID 
	(lastID < cartID) ifTrue: [self error: self class invalidCartIDErrorDescription].
	^(carts at: cartID) listItems.
	! !

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:31:43'!
ERROR!
!Cart methodsFor: 'queries' stamp: 'Simon 11/3/2022 21:31:52'!
listItems
	self shouldBeImplemented.! !
!Cart methodsFor: 'queries' stamp: 'Simon 11/3/2022 21:32:07' prior: 50556114!
listItems
	items asBag copy.! !
!Cart methodsFor: 'queries' stamp: 'Simon 11/3/2022 21:33:44' prior: 50556118!
listItems
	^ items asBag copy.! !

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:34:52'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:34:54'!
PASSED!
!Cart methodsFor: 'queries' stamp: 'Simon 11/3/2022 21:36:45' prior: 50556122!
listItems
	"Tenemos la alternativa de que el Cart se encarge de iterar sobre sus items o que los devuelva para que otro objeto los procese. Ya que creemos que convertirlo a string no le compete al Cart implementamos esta opcin."
	^ items asBag copy.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:39:34'!
test05ListCartWithManyBook

	| cartID isbn expected isbn2 |
	isbn := '1'.
	isbn2 := '2'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 2.
	restInterface addToCart: cartID aBook: isbn2 times: 1.
	
	expected _ Bag new.
	expected add: isbn withOccurrences: 2.
	expected add: isbn2.
	
	self assert: (restInterface listCart: cartID) equals: expected .
	
	! !

!testRun: #RestInterfaceTest #test05ListCartWithManyBook stamp: 'Simon 11/3/2022 21:39:44'!
ERROR!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:40:21' prior: 50556143!
test05ListCartWithManyBook

	| cartID isbn expected isbn2 |
	isbn := '1'.
	isbn2 := '2'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 2.
	restInterface addToCart: cartID aBook: isbn2 times: 1.
	
	expected := Bag new.
	expected add: isbn withOccurrences: 2.
	expected add: isbn2.
	
	self assert: (restInterface listCart: cartID) equals: expected .
	
	! !

!testRun: #RestInterfaceTest #test05ListCartWithManyBook stamp: 'Simon 11/3/2022 21:40:24'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 21:40:24'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:40:24'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 21:40:24'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:40:24'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBook stamp: 'Simon 11/3/2022 21:40:24'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:40:53'!
test05ListCartWithManyBooks

	| cartID isbn expected isbn2 |
	isbn := '1'.
	isbn2 := '2'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 2.
	restInterface addToCart: cartID aBook: isbn2 times: 1.
	
	expected := Bag new.
	expected add: isbn withOccurrences: 2.
	expected add: isbn2.
	
	self assert: (restInterface listCart: cartID) equals: expected .
	
	! !

!methodRemoval: RestInterfaceTest #test05ListCartWithManyBook stamp: 'Simon 11/3/2022 21:40:53'!
test05ListCartWithManyBook

	| cartID isbn expected isbn2 |
	isbn := '1'.
	isbn2 := '2'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 2.
	restInterface addToCart: cartID aBook: isbn2 times: 1.
	
	expected := Bag new.
	expected add: isbn withOccurrences: 2.
	expected add: isbn2.
	
	self assert: (restInterface listCart: cartID) equals: expected .
	
	!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:43:04'!
test06CannotAddToInvalidCartID

	self should: [restInterface addToCart: 10000 aBook: '1' times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/3/2022 21:43:10'!
FAILURE!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 21:44:54' prior: 50556104!
listCart: cartID 
	^(carts at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription]) listItems.
! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 21:44:56'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:44:56'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 21:44:56'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:44:56'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/3/2022 21:44:56'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/3/2022 21:44:56'!
FAILURE!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/3/2022 21:44:56'!
FAILURE!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 21:45:05'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 21:45:05'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:45:05'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 21:45:05'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:45:05'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/3/2022 21:45:05'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/3/2022 21:45:05'!
FAILURE!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/3/2022 21:45:05'!
FAILURE!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 21:45:44' prior: 50555890!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := carts at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription].
	cart add: quantity of: bookISBN.
	carts at: cartID put: cart.
	^'OK'.! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 21:45:46'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:45:46'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 21:45:46'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:45:46'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/3/2022 21:45:46'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/3/2022 21:45:46'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:46:38'!
test06CannotAddInvalidBook

	self should: [restInterface addToCart: 1 aBook: '1' times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:48:31' prior: 50556331!
test06CannotAddInvalidBook

	| cartID isbn |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	
	self should: [restInterface addToCart: 1 aBook: 	testObjectsFactory invalid times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:49:05'!
test07CannotAddInvalidBook

	| cartID isbn |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	
	self should: [restInterface addToCart: 1 aBook: 	testObjectsFactory invalid times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !

!methodRemoval: RestInterfaceTest #test06CannotAddInvalidBook stamp: 'Simon 11/3/2022 21:49:05'!
test06CannotAddInvalidBook

	| cartID isbn |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	
	self should: [restInterface addToCart: 1 aBook: 	testObjectsFactory invalid times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:49:32' prior: 50556354!
test07CannotAddInvalidBook

	| cartID isbn |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	
	self should: [restInterface addToCart: 1 aBook: 	testObjectsFactory itemNotSellByTheStore times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !

!testRun: #RestInterfaceTest #test07CannotAddInvalidBook stamp: 'Simon 11/3/2022 21:49:37'!
FAILURE!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:51:13'!
test07CannotAddInvalidQuantityBook

	| cartID isbn |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	
	self should: [restInterface addToCart: 1 aBook: 	testObjectsFactory itemNotSellByTheStore times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !

!methodRemoval: RestInterfaceTest #test07CannotAddInvalidBook stamp: 'Simon 11/3/2022 21:51:13'!
test07CannotAddInvalidBook

	| cartID isbn |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	
	self should: [restInterface addToCart: 1 aBook: 	testObjectsFactory itemNotSellByTheStore times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:51:40' prior: 50556398!
test07CannotAddInvalidQuantityBook

	| cartID isbn |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	
	self should: [restInterface addToCart: 0 aBook: 	testObjectsFactory itemSellByTheStore times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/3/2022 21:51:45'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 21:51:45'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:51:45'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 21:51:45'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:51:45'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/3/2022 21:51:45'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/3/2022 21:51:45'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/3/2022 21:51:45'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:52:06' prior: 50556426!
test07CannotAddInvalidQuantityBook

	| cartID isbn |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	
	self should: [restInterface addToCart: cartID aBook: 	testObjectsFactory itemSellByTheStore times:0]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class .
	
	! !

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/3/2022 21:52:10'!
FAILURE!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/3/2022 21:53:58' prior: 50556301!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := carts at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription].
	(quantity >=1) ifFalse: [self error: self class invalidQuantityErrorDescription].
	cart add: quantity of: bookISBN.
	carts at: cartID put: cart.
	^'OK'.! !

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/3/2022 21:54:12'!
ERROR!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/3/2022 21:54:12'!
ERROR!
!InternalRestInterface class methodsFor: 'errors' stamp: 'Simon 11/3/2022 21:54:20'!
invalidQuantityErrorDescription
	self shouldBeImplemented.! !
!InternalRestInterface class methodsFor: 'errors' stamp: 'Simon 11/3/2022 21:55:02' prior: 50556504!
invalidQuantityErrorDescription
	^'Quantity must be one or more'.! !
!InternalRestInterface class methodsFor: 'errors' stamp: 'Simon 11/3/2022 21:55:10' prior: 50556510!
invalidQuantityErrorDescription
	^'Quantity of items must be one or more'.! !

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/3/2022 21:55:13'!
FAILURE!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:55:30' prior: 50556467!
test07CannotAddInvalidQuantityBook

	| cartID isbn |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	
	self should: [restInterface addToCart: cartID aBook: 	testObjectsFactory itemSellByTheStore times:0]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidQuantityErrorDescription .
	
	! !

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/3/2022 21:55:32'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 21:55:32'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:55:32'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 21:55:32'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:55:32'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/3/2022 21:55:32'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/3/2022 21:55:32'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/3/2022 21:55:32'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/3/2022 21:55:40' prior: 50556525!
test07CannotAddInvalidQuantityBook

	| cartID |
	cartID:= restInterface createCartFor: clientId with: password.
	
	self should: [restInterface addToCart: cartID aBook: 	testObjectsFactory itemSellByTheStore times:0]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidQuantityErrorDescription .
	
	! !

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/3/2022 21:55:44'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/3/2022 21:55:44'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/3/2022 21:55:44'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/3/2022 21:55:44'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/3/2022 21:55:44'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/3/2022 21:55:44'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/3/2022 21:55:44'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/3/2022 21:55:44'!
PASSED!

----SNAPSHOT----(3 November 2022 21:56:15) CuisUniversity-5510.image priorSource: 7235707!

----STARTUP---- (5 November 2022 15:36:15) as /Users/simonlew/Documents/ISW/mac/CuisUniversity-5510.image!


----End fileIn of /Users/simonlew/Downloads/TusLibros.st----!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 15:38:04'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 15:49:59'!
test08CannotAddToExperiedCartID

	| cartId |
	self should: [  restInterface addToCart: cartId aBook: '1' times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:03:19'!
test08CannotAddToExpiredCartID

	| cartId |
	self should: [  restInterface addToCart: cartId aBook: '1' times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !

!methodRemoval: RestInterfaceTest #test08CannotAddToExperiedCartID stamp: 's 11/5/2022 16:03:19'!
test08CannotAddToExperiedCartID

	| cartId |
	self should: [  restInterface addToCart: cartId aBook: '1' times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	!
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:06:36' prior: 50556035!
test08CannotAddToExpiredCartID

	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	
	self timePast: (30 * minute).
	
	self should: [  restInterface addToCart: cartID aBook: '1' times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:06:46'!
ERROR!
!RestInterfaceTest methodsFor: 'time' stamp: 's 11/5/2022 16:07:00'!
timePast: aString 
	self shouldBeImplemented.! !

!classDefinition: #RestInterfaceTest category: 'TusLibros' stamp: 's 11/5/2022 16:07:53'!
TestCase subclass: #RestInterfaceTest
	instanceVariableNames: 'testObjectsFactory restInterface authenticationBehavior clientId password time'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!RestInterfaceTest methodsFor: 'time' stamp: 's 11/5/2022 16:07:50' prior: 50556071!
timePast: aTime 
	time:= time + aTime.! !

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:07:58'!
ERROR!
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:10:07' prior: 50555532 overrides: 16961394!
setUp 
	
	testObjectsFactory := StoreTestObjectsFactory new.
	
	time := testObjectsFactory today.
	
	restInterface := InternalRestInterface withAuthenticator: self andCatalog: testObjectsFactory defaultCatalog on: time.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := true.
	
	! !
!InternalRestInterface class methodsFor: 'instance creation' stamp: 's 11/5/2022 16:10:22'!
withAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWithAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime ! !
!InternalRestInterface class methodsFor: 'instance creation' stamp: 's 11/5/2022 16:10:38' prior: 50556106!
withAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime 
	^self new initializeWithAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime ! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 's 11/5/2022 16:11:09'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID carts catalog restInterfaceTest'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 's 11/5/2022 16:11:09'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID carts catalog restInterfaceTest dictionary'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 's 11/5/2022 16:11:09'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID carts catalog restInterfaceTest dictionary dateAndTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'initialize' stamp: 's 11/5/2022 16:11:09'!
initializeWithAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime 
	self shouldBeImplemented.
	restInterfaceTest := aRestInterfaceTest.
	dictionary := aDictionary.
	dateAndTime := aDateAndTime.! !
!InternalRestInterface methodsFor: 'initialize' stamp: 's 11/5/2022 16:12:12' prior: 50556155!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime 
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.
	dateAndTime := aDateAndTime.! !

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:12:37'!
ERROR!

aTime!

time!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 16:16:46'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 16:16:46'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 16:16:46'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 16:16:46'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 16:16:46'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 16:16:46'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 16:16:46'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:17:32' prior: 50556055!
test08CannotAddToExpiredCartID

	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	
	self timePast: (Duration minutes: 30).
	
	self should: [  restInterface addToCart: cartID aBook: '1' times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:17:37'!
FAILURE!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:17:42'!
FAILURE!

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 's 11/5/2022 16:20:22'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID carts catalog restInterfaceTest dictionary dateAndTime cartsLastUsed'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:20:17' prior: 50555872!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := carts at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription].
	 cartsLastUsed at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription].
	(quantity >=1) ifFalse: [self error: self class invalidQuantityErrorDescription].
	cart add: quantity of: bookISBN.
	carts at: cartID put: cart.
	^'OK'.! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 's 11/5/2022 16:20:55'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID carts catalog restInterfaceTest dictionary actualTime cartsLastUsed'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 's 11/5/2022 16:20:55' prior: 50556165!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime 
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:23:41' prior: 50556231!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := carts at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription].
	 ((actualTime - cartsLastUsed at: cartID) > Duration minutes: 30) ifTrue:[self error: self class invalidCartIDErrorDescription].
	(quantity >=1) ifFalse: [self error: self class invalidQuantityErrorDescription].
	cart add: quantity of: bookISBN.
	carts at: cartID put: cart.
	^'OK'.! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:24:00' prior: 50556267!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := carts at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription].
	 ((actualTime - (cartsLastUsed at: cartID) ) > Duration minutes: 30) ifTrue:[self error: self class invalidCartIDErrorDescription].
	(quantity >=1) ifFalse: [self error: self class invalidQuantityErrorDescription].
	cart add: quantity of: bookISBN.
	carts at: cartID put: cart.
	^'OK'.! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:24:29' prior: 50556284!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := carts at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription].
	 ((actualTime - (cartsLastUsed at: cartID) ) >= (Duration minutes: 30)) ifTrue:[self error: self class invalidCartIDErrorDescription].
	(quantity >=1) ifFalse: [self error: self class invalidQuantityErrorDescription].
	cart add: quantity of: bookISBN.
	carts at: cartID put: cart.
	^'OK'.! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:25:04' prior: 50556301!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := carts at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription].
	 ((actualTime - (cartsLastUsed at: cartID) ) >= (Duration minutes: 30)) ifTrue:[self error: self class expiredCartIDErrorDescription].
	(quantity >=1) ifFalse: [self error: self class invalidQuantityErrorDescription].
	cart add: quantity of: bookISBN.
	carts at: cartID put: cart.
	^'OK'.! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 16:25:38'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 16:25:38'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 16:25:38'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 16:25:38'!
ERROR!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 16:25:38'!
ERROR!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 16:25:38'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 16:25:38'!
FAILURE!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:25:38'!
FAILURE!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 16:25:41'!
ERROR!
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:26:42' prior: 50555884!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	carts at: lastID put: (Cart acceptingItemsOf: catalog).
	cartsLastUsed at: lastID put: actualTime .
	^lastID.! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 16:27:03'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 16:27:03'!
ERROR!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 16:27:03'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 16:27:03'!
ERROR!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 16:27:03'!
ERROR!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 16:27:03'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 16:27:03'!
ERROR!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:27:03'!
ERROR!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 16:27:12'!
ERROR!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 16:27:50'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 16:27:50'!
ERROR!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 16:27:50'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 16:27:50'!
ERROR!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 16:27:50'!
ERROR!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 16:27:50'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 16:27:50'!
ERROR!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:27:50'!
ERROR!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 16:28:12'!
ERROR!
!InternalRestInterface methodsFor: 'initialize' stamp: 's 11/5/2022 16:28:57' prior: 50556257!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime 
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 16:29:02'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 16:29:02'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 16:29:02'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 16:29:02'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 16:29:02'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 16:29:02'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 16:29:02'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:29:02'!
FAILURE!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:29:02'!
FAILURE!
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:29:42' prior: 50556201!
test08CannotAddToExpiredCartID

	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	
	self timePast: (Duration minutes: 31).
	
	self should: [  restInterface addToCart: cartID aBook: '1' times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:29:44'!
FAILURE!
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:30:13' prior: 50556471!
test08CannotAddToExpiredCartID

	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	
	self timePast: (Duration minutes: 31).
	
	self should: [  restInterface addToCart: cartID aBook: '1' times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class expiredCartIDErrorDescription.
	
	! !

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:30:15'!
ERROR!
!InternalRestInterface class methodsFor: 'errors' stamp: 's 11/5/2022 16:30:24'!
expiredCartIDErrorDescription
	self shouldBeImplemented.! !
!InternalRestInterface class methodsFor: 'errors' stamp: 's 11/5/2022 16:30:56' prior: 50556505!
expiredCartIDErrorDescription
	^'Carts expire after 30 minutes'.! !

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:31:04'!
FAILURE!

(cartsLastUsed at: cartID)!

(actualTime - (cartsLastUsed at: cartID) )!

actualTime!

(cartsLastUsed at: cartID) !
!RestInterfaceTest methodsFor: 'time' stamp: 's 11/5/2022 16:35:22' prior: 50556085!
timePast: aTime 
	restInterface timePast: aTime.! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 16:35:30'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 16:35:30'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 16:35:30'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 16:35:30'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 16:35:30'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 16:35:30'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 16:35:30'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:35:30'!
ERROR!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:35:30'!
ERROR!
!InternalRestInterface methodsFor: 'time' stamp: 's 11/5/2022 16:35:42'!
timePast: aTime 
	self shouldBeImplemented.! !
!InternalRestInterface methodsFor: 'time' stamp: 's 11/5/2022 16:36:06' prior: 50556555!
timePast: aTime 
	actualTime := actualTime + aTime .! !

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:36:08'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 16:36:13'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 16:36:13'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 16:36:13'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 16:36:13'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 16:36:13'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 16:36:13'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 16:36:13'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:36:13'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:37:09'!
test09CannotListExpiredCartID

	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	
	self timePast: (Duration minutes: 31).
	
	self should: [  restInterface addToCart: cartID aBook: '1' times:1]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class expiredCartIDErrorDescription.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:37:25' prior: 50556593!
test09CannotListExpiredCartID

	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	
	self timePast: (Duration minutes: 31).
	
	self should: [  restInterface listCart: cartID ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class expiredCartIDErrorDescription.
	
	! !

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 's 11/5/2022 16:37:29'!
FAILURE!
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:38:38' prior: 50555892!
listCart: cartID 
	 ((actualTime - (cartsLastUsed at: cartID) ) >= (Duration minutes: 30)) ifTrue:[self error: self class expiredCartIDErrorDescription].
	^(carts at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription]) listItems.
! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:39:30' prior: 50556623!
listCart: cartID 
	| cart |
	cart := carts at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription].
	 ((actualTime - (cartsLastUsed at: cartID) ) >= (Duration minutes: 30)) ifTrue:[self error: self class expiredCartIDErrorDescription].
	^cart listItems.
! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:40:20'!
obtainValidCart: cartID

	^ carts at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription]! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:40:20' prior: 50556634!
listCart: cartID 
	| cart |
	cart := self obtainValidCart: cartID.
	 ((actualTime - (cartsLastUsed at: cartID) ) >= (Duration minutes: 30)) ifTrue:[self error: self class expiredCartIDErrorDescription].
	^cart listItems.
! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:40:20' prior: 50556318!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := self obtainValidCart: cartID.
	 ((actualTime - (cartsLastUsed at: cartID) ) >= (Duration minutes: 30)) ifTrue:[self error: self class expiredCartIDErrorDescription].
	(quantity >=1) ifFalse: [self error: self class invalidQuantityErrorDescription].
	cart add: quantity of: bookISBN.
	carts at: cartID put: cart.
	^'OK'.! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:41:10'!
expirationTimeForCarts

	^ Duration minutes: 30! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:41:10' prior: 50556652!
listCart: cartID 
	| cart |
	cart := self obtainValidCart: cartID.
	 ((actualTime - (cartsLastUsed at: cartID) ) >= (self expirationTimeForCarts)) ifTrue:[self error: self class expiredCartIDErrorDescription].
	^cart listItems.
! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:41:10' prior: 50556662!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := self obtainValidCart: cartID.
	 ((actualTime - (cartsLastUsed at: cartID) ) >= (self expirationTimeForCarts)) ifTrue:[self error: self class expiredCartIDErrorDescription].
	(quantity >=1) ifFalse: [self error: self class invalidQuantityErrorDescription].
	cart add: quantity of: bookISBN.
	carts at: cartID put: cart.
	^'OK'.! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:42:07'!
CanBeUsed: aCartID
	 ((actualTime - (cartsLastUsed at: aCartID) ) >= (self expirationTimeForCarts)) ifTrue:[self error: self class expiredCartIDErrorDescription].

! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:42:39'!
canBeUsed: aCartID
	 ((actualTime - (cartsLastUsed at: aCartID) ) >= (self expirationTimeForCarts)) ifTrue:[self error: self class expiredCartIDErrorDescription].

! !

!methodRemoval: InternalRestInterface #CanBeUsed: stamp: 's 11/5/2022 16:42:39'!
CanBeUsed: aCartID
	 ((actualTime - (cartsLastUsed at: aCartID) ) >= (self expirationTimeForCarts)) ifTrue:[self error: self class expiredCartIDErrorDescription].

!
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:42:57' prior: 50556693!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := self obtainValidCart: cartID.
	self canBeUsed: cartID .
	(quantity >=1) ifFalse: [self error: self class invalidQuantityErrorDescription].
	cart add: quantity of: bookISBN.
	carts at: cartID put: cart.
	^'OK'.! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:43:27' prior: 50556682!
listCart: cartID 
	| cart |
	cart := self obtainValidCart: cartID.
	self canBeUsed: cartID .
	^cart listItems.
! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 16:43:40'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 16:43:40'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 16:43:40'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 16:43:40'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 16:43:40'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 16:43:40'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 16:43:40'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:43:40'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 's 11/5/2022 16:43:40'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:46:37'!
test10CannotCheckoutExpiredCartID

	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	
	self timePast: (Duration minutes: 31).
	
	self should: [  restInterface checkOutCart: cartID payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class expiredCartIDErrorDescription.
	
	! !

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 's 11/5/2022 16:46:43'!
ERROR!
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:47:35'!
checkOutCart: cartID payingWith: aString 
	self shouldBeImplemented.! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:48:04' prior: 50556797!
checkOutCart: cartID payingWith: aString 
	self canBeUsed: cartID .! !

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 's 11/5/2022 16:48:08'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 16:48:08'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 16:48:08'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 16:48:08'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 16:48:08'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 16:48:08'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 16:48:08'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 16:48:08'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:48:08'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 's 11/5/2022 16:48:08'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 's 11/5/2022 16:48:08'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:49:37'!
test11CannotCheckOutInvalidCartID

	self should: [restInterface checkOutCart: 1000 payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 16:49:48'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 16:49:48'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 16:49:48'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 16:49:48'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 16:49:48'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 16:49:48'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 16:49:48'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:49:48'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 's 11/5/2022 16:49:48'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 's 11/5/2022 16:49:48'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 's 11/5/2022 16:49:48'!
FAILURE!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 's 11/5/2022 16:49:48'!
FAILURE!
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 16:50:45' prior: 50556803!
checkOutCart: cartID payingWith: aString 

	| cart |
	cart := self obtainValidCart: cartID .
	self canBeUsed: cartID .! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 16:50:53'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 16:50:53'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 16:50:53'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 16:50:53'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 16:50:53'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 16:50:53'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 16:50:53'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 16:50:53'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 's 11/5/2022 16:50:53'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 's 11/5/2022 16:50:53'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 's 11/5/2022 16:50:53'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:52:01'!
test11CannotCheckOutEmptyCartID

	self should: [restInterface checkOutCart:  1 payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:52:15'!
test12CannotCheckOutEmptyCartID

	self should: [restInterface checkOutCart:  1 payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !

!methodRemoval: RestInterfaceTest #test11CannotCheckOutEmptyCartID stamp: 's 11/5/2022 16:52:15'!
test11CannotCheckOutEmptyCartID

	self should: [restInterface checkOutCart:  1 payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	!
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:52:38' prior: 50556944!
test12CannotCheckOutEmptyCartID
	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	self assert: (restInterface listCart: cartID) isEmpty.
	self should: [restInterface checkOutCart:  1 payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:52:45' prior: 50556966!
test12CannotCheckOutEmptyCartID
	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	self assert: (restInterface listCart: cartID) isEmpty.
	self should: [restInterface checkOutCart:  cartID payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:52:50' prior: 50556981!
test12CannotCheckOutEmptyCartID
	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	self should: [restInterface checkOutCart:  cartID payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:53:02' prior: 50556996!
test12CannotCheckOutEmptyCartID
	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	self should: [restInterface checkOutCart:  cartID payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class emptyCartErrorDescription.
	
	! !

!testRun: #RestInterfaceTest #test12CannotCheckOutEmptyCartID stamp: 's 11/5/2022 16:53:07'!
ERROR!
!InternalRestInterface class methodsFor: 'errors' stamp: 's 11/5/2022 16:53:23'!
emptyCartErrorDescription
	self shouldBeImplemented.! !

!methodRemoval: RestInterfaceTest #test12CannotCheckOutEmptyCartID stamp: 's 11/5/2022 16:54:59'!
test12CannotCheckOutEmptyCartID
	| cartID |
	
	cartID:= restInterface createCartFor: clientId with: password.
	self assert: (restInterface listCart: cartID) isEmpty.
	
	self should: [restInterface checkOutCart:  cartID payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class emptyCartErrorDescription.
	
	!
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 16:58:33'!
test12ListPurchasesAfterCheckingOutACartWithOneBook

	| cartID isbn expected |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expected _ Bag new.
	expected add: isbn.
	
	restInterface checkOutCart: cartID payingWith: testObjectsFactory notExpiredCreditCard .
	
	self assert: (restInterface listPurchasesOf: clientId with: password ) equals: expected .
	
	! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 16:58:40'!
ERROR!
!InternalRestInterface methodsFor: 'purchases' stamp: 's 11/5/2022 16:59:11'!
listPurchasesOf: clientId with: password 
	self shouldBeImplemented.! !
!InternalRestInterface methodsFor: 'purchases' stamp: 's 11/5/2022 17:00:10' prior: 50557069!
listPurchasesOf: clientId with: password 
	self assertValid: clientId with: password .! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 's 11/5/2022 17:03:10'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID carts catalog restInterfaceTest dictionary actualTime cartsLastUsed cartsByClient'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'purchases' stamp: 's 11/5/2022 17:03:02' prior: 50557075!
listPurchasesOf: clientId with: password 
	self assertValid: clientId with: password .
	(cartsByClient at: clientId ) inject: (Bag new) into: [ :list :cart | list addAll: cart listItems ]! !
!InternalRestInterface methodsFor: 'purchases' stamp: 's 11/5/2022 17:03:40' prior: 50557092!
listPurchasesOf: clientId with: password 
	self assertValid: clientId with: password .
	^(cartsByClient at: clientId ) inject: (Bag new) into: [ :list :cart | list addAll: cart listItems. list ].! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:03:43'!
ERROR!

!methodRemoval: InternalRestInterface #initializeWithAuthenticator:andCatalog: stamp: 's 11/5/2022 17:04:21'!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.!
!InternalRestInterface methodsFor: 'initialize' stamp: 's 11/5/2022 17:04:55' prior: 50556431!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime 
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 17:05:54' prior: 50556364!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	carts at: lastID put: (Cart acceptingItemsOf: catalog).
	cartsLastUsed at: lastID put: actualTime .
	cartsByClient at: clientId put: lastID .
	^lastID.! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 17:06:02'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 17:06:02'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 17:06:02'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 17:06:02'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 17:06:02'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 17:06:02'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 17:06:02'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 17:06:02'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 's 11/5/2022 17:06:02'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 's 11/5/2022 17:06:02'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 's 11/5/2022 17:06:02'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:06:02'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:06:02'!
ERROR!
!InternalRestInterface methodsFor: 'purchases' stamp: 's 11/5/2022 17:06:59' prior: 50557101!
listPurchasesOf: clientId with: password 
	self assertValid: clientId with: password .
	^(cartsByClient at: clientId ) inject: (Bag new) into: [ :list :cartID | list addAll: (self obtainValidCart: cartID ) list ].! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:07:07'!
ERROR!
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 17:08:00' prior: 50557137!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	carts at: lastID put: (Cart acceptingItemsOf: catalog).
	cartsLastUsed at: lastID put: actualTime .
	(cartsByClient at: clientId )add: lastID .
	^lastID.! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 17:10:37' prior: 50557205!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	carts at: lastID put: (Cart acceptingItemsOf: catalog).
	cartsLastUsed at: lastID put: actualTime .
	(cartsByClient at: clientId ifAbsent: [Set new]) add: lastID .
	^lastID.! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 17:10:40'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 17:10:40'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 17:10:40'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 17:10:40'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 17:10:40'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 17:10:40'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 17:10:40'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 17:10:40'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 's 11/5/2022 17:10:40'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 's 11/5/2022 17:10:40'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 's 11/5/2022 17:10:40'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:10:40'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:10:40'!
ERROR!
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 17:11:36' prior: 50557217!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	carts at: lastID put: (Cart acceptingItemsOf: catalog).
	cartsLastUsed at: lastID put: actualTime .
	cartsByClient at: clientId put: ((cartsByClient at: clientId ifAbsent: [Set new]) add: lastID; yourself ).
	^lastID.! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 17:11:38'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 17:11:38'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 17:11:38'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 17:11:38'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 17:11:38'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 17:11:38'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 17:11:38'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 17:11:38'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 's 11/5/2022 17:11:38'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 's 11/5/2022 17:11:38'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 's 11/5/2022 17:11:38'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:11:38'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:11:38'!
ERROR!
!InternalRestInterface methodsFor: 'purchases' stamp: 's 11/5/2022 17:12:15' prior: 50557191!
listPurchasesOf: clientId with: password 
	self assertValid: clientId with: password .
	^(cartsByClient at: clientId ) inject: (Bag new) into: [ :list :cartID | list addAll: (self obtainValidCart: cartID ) listItems . list].! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:12:18'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 17:12:21'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 17:12:21'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 17:12:21'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 17:12:21'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 17:12:21'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 17:12:21'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 17:12:21'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 17:12:21'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 's 11/5/2022 17:12:21'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 's 11/5/2022 17:12:21'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 's 11/5/2022 17:12:21'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:12:21'!
PASSED!
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 17:13:59'!
obtainCartsIdOf: clientId
	^(cartsByClient at: clientId ifAbsent: [Set new]) add: lastID; yourself .! !
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 17:14:26' prior: 50557272!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	carts at: lastID put: (Cart acceptingItemsOf: catalog).
	cartsLastUsed at: lastID put: actualTime .
	cartsByClient at: clientId put: (self obtainCartsIdOf: clientId ).
	^lastID.! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 17:14:31'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 17:14:31'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 17:14:31'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 17:14:31'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 17:14:31'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 17:14:31'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 17:14:31'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 17:14:31'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 's 11/5/2022 17:14:31'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 's 11/5/2022 17:14:31'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 's 11/5/2022 17:14:31'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:14:31'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 17:20:33'!
test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks

	| cart1 cart2 isbn1 isbn2 expected |
	isbn1 := '1'.
	isbn2 := '2'.
	
	cart1:= restInterface createCartFor: clientId with: password.
	cart2:= restInterface createCartFor: clientId with: password.
	
	restInterface addToCart: cart1 aBook: isbn1 times: 1.
	restInterface addToCart: cart1 aBook: isbn2 times: 3.
	restInterface addToCart: cart2 aBook: isbn1 times: 1. 
	
	expected _ Bag new.
	expected add: isbn1 withOccurrences: 2.
	expected add: isbn1 withOccurrences: 2.
	
	restInterface checkOutCart: cart1 payingWith: testObjectsFactory notExpiredCreditCard .
	
	self assert: (restInterface listPurchasesOf: clientId with: password ) equals: expected .
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 17:24:15'!
test13ListPurchasesAfterCheckingOutOnlyOneCart

	| cart1 cart2 isbn1 isbn2 expected |
	isbn1 := '1'.
	isbn2 := '2'.
	
	cart1:= restInterface createCartFor: clientId with: password.
	cart2:= restInterface createCartFor: clientId with: password.
	
	restInterface addToCart: cart1 aBook: isbn1 times: 1.
	restInterface addToCart: cart1 aBook: isbn2 times: 3.
	restInterface addToCart: cart2 aBook: isbn1 times: 1. 
	
	expected _ Bag new.
	expected add: isbn1 withOccurrences: 1.
	expected add: isbn2 withOccurrences: 3.
	
	restInterface checkOutCart: cart1 payingWith: testObjectsFactory notExpiredCreditCard .
	
	self assert: (restInterface listPurchasesOf: clientId with: password ) equals: expected .
	
	! !

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 's 11/5/2022 17:24:24'!
FAILURE!
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 17:27:34' prior: 50556892!
checkOutCart: cartID payingWith: aCreditCard 

	| cart |
	cart := self obtainValidCart: cartID .
	self canBeUsed: cartID .
	Cashier toCheckout: cart charging: aCreditCard  throught: 	StoreTestObjectsFactory on:  actualTime .! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 's 11/5/2022 17:30:56'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID carts catalog restInterfaceTest dictionary actualTime cartsLastUsed cartsByClient merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 's 11/5/2022 17:30:59'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID carts catalog restInterfaceTest dictionary actualTime cartsLastUsed cartsByClient merchantProcessor salesBooks'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 17:30:48' prior: 50557492!
checkOutCart: cartID payingWith: aCreditCard 

	| cart |
	cart := self obtainValidCart: cartID .
	self canBeUsed: cartID .
	Cashier toCheckout: cart charging: aCreditCard  throught: merchantProcessor on:  actualTime registeringOn: (salesBooks at: cartID ).! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 17:31:10'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 17:31:10'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 17:31:10'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 17:31:10'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 17:31:10'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 17:31:10'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 17:31:10'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 17:31:10'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 's 11/5/2022 17:31:10'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 's 11/5/2022 17:31:10'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 's 11/5/2022 17:31:10'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:31:10'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 's 11/5/2022 17:31:10'!
ERROR!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 's 11/5/2022 17:31:10'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:31:13'!
ERROR!
!InternalRestInterface methodsFor: 'initialize' stamp: 's 11/5/2022 17:32:48'!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.
	salesBooks := Dictionary new.
	merchantProcessor := aMerchantProcessor .! !
!InternalRestInterface methodsFor: 'initialize' stamp: 's 11/5/2022 17:33:42'!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMPP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.
	salesBooks := Dictionary new.
	merchantProcessor := aMerchantProcessor .! !

!methodRemoval: InternalRestInterface #initializeWithAuthenticator:andCatalog:on:withMP: stamp: 's 11/5/2022 17:33:42'!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.
	salesBooks := Dictionary new.
	merchantProcessor := aMerchantProcessor .!
!InternalRestInterface methodsFor: 'initialize' stamp: 's 11/5/2022 17:34:44'!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMp: aMerchantProcessor  
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.! !
!InternalRestInterface class methodsFor: 'as yet unclassified' stamp: 's 11/5/2022 17:34:44' prior: 50556119!
withAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime 
	^self new initializeWithAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime withMp: self ! !

!methodRemoval: InternalRestInterface #initializeWithAuthenticator:andCatalog:on: stamp: 's 11/5/2022 17:34:44'!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime 
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.!

!methodRemoval: InternalRestInterface #initializeWithAuthenticator:andCatalog:on:withMp: stamp: 's 11/5/2022 17:35:00'!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMp: aMerchantProcessor  
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.!
!InternalRestInterface methodsFor: 'initialize' stamp: 's 11/5/2022 17:35:06'!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.
	salesBooks := Dictionary new.
	merchantProcessor := aMerchantProcessor .! !

!methodRemoval: InternalRestInterface #initializeWithAuthenticator:andCatalog:on:withMPP: stamp: 's 11/5/2022 17:35:06'!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMPP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.
	salesBooks := Dictionary new.
	merchantProcessor := aMerchantProcessor .!
!InternalRestInterface class methodsFor: 'instance creation' stamp: 's 11/5/2022 17:35:37' prior: 50557647!
withAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime 
	^self new initializeWithAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime withMP: self.! !
!InternalRestInterface class methodsFor: 'instance creation' stamp: 's 11/5/2022 17:36:20'!
withAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime withMp: aMerchantProcessor  
	^self new initializeWithAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime withMP: self.! !
!RestInterfaceTest methodsFor: 'as yet unclassified' stamp: 's 11/5/2022 17:36:20' prior: 50556093 overrides: 16961394!
setUp 
	
	testObjectsFactory := StoreTestObjectsFactory new.
	
	time := testObjectsFactory today.
	
	restInterface := InternalRestInterface withAuthenticator: self andCatalog: testObjectsFactory defaultCatalog on: time withMp: self.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := true.
	
	! !

!methodRemoval: InternalRestInterface class #withAuthenticator:andCatalog:on: stamp: 's 11/5/2022 17:36:20'!
withAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime 
	^self new initializeWithAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime withMP: self.!

!classDefinition: #RestInterfaceTest category: 'TusLibros' stamp: 's 11/5/2022 17:38:53'!
TestCase subclass: #RestInterfaceTest
	instanceVariableNames: 'testObjectsFactory restInterface authenticationBehavior clientId password time debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!RestInterfaceTest methodsFor: 'tests' stamp: 's 11/5/2022 17:38:50' prior: 50557737 overrides: 16961394!
setUp 
	
	testObjectsFactory := StoreTestObjectsFactory new.
	
	time := testObjectsFactory today.
	
	restInterface := InternalRestInterface withAuthenticator: self andCatalog: testObjectsFactory defaultCatalog on: time withMp: self.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := true.
	
	debitBehavior := [ :anAmount :aCreditCard | ]
	
	! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 's 11/5/2022 17:39:03'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 's 11/5/2022 17:39:03'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 's 11/5/2022 17:39:03'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 's 11/5/2022 17:39:03'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 's 11/5/2022 17:39:03'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 's 11/5/2022 17:39:03'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 's 11/5/2022 17:39:03'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 's 11/5/2022 17:39:03'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 's 11/5/2022 17:39:03'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 's 11/5/2022 17:39:03'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 's 11/5/2022 17:39:03'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:39:03'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 's 11/5/2022 17:39:03'!
ERROR!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 's 11/5/2022 17:39:03'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 's 11/5/2022 17:39:07'!
ERROR!
!InternalRestInterface methodsFor: 'carts' stamp: 's 11/5/2022 17:41:14' prior: 50557525!
checkOutCart: cartID payingWith: aCreditCard 

	| cart salesBook |
	cart := self obtainValidCart: cartID .
	self canBeUsed: cartID .
	Cashier toCheckout: cart charging: aCreditCard  throught: merchantProcessor on:  actualTime registeringOn: (salesBook).! !

----SNAPSHOT----(5 November 2022 17:46:40) CuisUniversity-5510.image priorSource: 7155150!

----STARTUP---- (6 November 2022 11:49:44) as C:\Users\Echu\Downloads\Inge 1\windows64\CuisUniversity-5510.image!


----End fileIn of C:\Users\Echu\Downloads\TusLibros (1).st----!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 11:58:17' prior: 50556033!
checkOutCart: cartID payingWith: aCreditCard 

	| cart salesBook |
	cart := self obtainValidCart: cartID .
	self canBeUsed: cartID.
	Cashier toCheckout: cart charging: aCreditCard  throught: merchantProcessor on:  actualTime registeringOn: (salesBook).! !
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/6/2022 11:58:51' prior: 50555998!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	carts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.
	salesBooks := Dictionary new.
	merchantProcessor := aMerchantProcessor .! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'Simon 11/6/2022 11:58:55'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID activeCarts catalog restInterfaceTest dictionary actualTime cartsLastUsed cartsByClient merchantProcessor salesBooks'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/6/2022 11:58:55' prior: 50556248!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	activeCarts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.
	salesBooks := Dictionary new.
	merchantProcessor := aMerchantProcessor .! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/6/2022 11:58:55' prior: 50556072!
obtainValidCart: cartID

	^ activeCarts at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription]! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/6/2022 11:58:55' prior: 50556013!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := self obtainValidCart: cartID.
	self canBeUsed: cartID .
	(quantity >=1) ifFalse: [self error: self class invalidQuantityErrorDescription].
	cart add: quantity of: bookISBN.
	activeCarts at: cartID put: cart.
	^'OK'.! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/6/2022 11:58:55' prior: 50556044!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	activeCarts at: lastID put: (Cart acceptingItemsOf: catalog).
	cartsLastUsed at: lastID put: actualTime .
	cartsByClient at: clientId put: (self obtainCartsIdOf: clientId ).
	^lastID.! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'Simon 11/6/2022 11:59:32'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID activeCarts catalog restInterfaceTest dictionary actualTime cartsLastUsed cartsByClient merchantProcessor salesBooks checkoutCarts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/6/2022 11:59:26' prior: 50556276!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	activeCarts := Dictionary new.
	checkoutCarts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.
	salesBooks := Dictionary new.
	merchantProcessor := aMerchantProcessor .! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 12:02:07'!
obtainActiveCart: cartID

	^ activeCarts at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription]! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/6/2022 12:02:07' prior: 50556090!
listPurchasesOf: clientId with: password 
	self assertValid: clientId with: password .
	^(cartsByClient at: clientId ) inject: (Bag new) into: [ :list :cartID | list addAll: (self obtainActiveCart: cartID ) listItems . list].! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/6/2022 12:02:07' prior: 50556060!
listCart: cartID 
	| cart |
	cart := self obtainActiveCart: cartID.
	self canBeUsed: cartID .
	^cart listItems.
! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/6/2022 12:02:07' prior: 50556301!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := self obtainActiveCart: cartID.
	self canBeUsed: cartID .
	(quantity >=1) ifFalse: [self error: self class invalidQuantityErrorDescription].
	cart add: quantity of: bookISBN.
	activeCarts at: cartID put: cart.
	^'OK'.! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/6/2022 12:02:07' prior: 50556236!
checkOutCart: cartID payingWith: aCreditCard 

	| cart salesBook |
	cart := self obtainActiveCart: cartID .
	self canBeUsed: cartID.
	Cashier toCheckout: cart charging: aCreditCard  throught: merchantProcessor on:  actualTime registeringOn: (salesBook).! !

!methodRemoval: InternalRestInterface #obtainValidCart: stamp: 'Simon 11/6/2022 12:02:07'!
obtainValidCart: cartID

	^ activeCarts at: cartID ifAbsent: [self error: self class invalidCartIDErrorDescription]!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'Simon 11/6/2022 12:02:11'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'Simon 11/6/2022 12:02:11'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'Simon 11/6/2022 12:02:11'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'Simon 11/6/2022 12:02:11'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'Simon 11/6/2022 12:02:11'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'Simon 11/6/2022 12:02:11'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'Simon 11/6/2022 12:02:11'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'Simon 11/6/2022 12:02:11'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'Simon 11/6/2022 12:02:11'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'Simon 11/6/2022 12:02:12'!
FAILURE!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:02:12'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:02:12'!
FAILURE!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 12:02:12'!
FAILURE!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'Simon 11/6/2022 12:02:23'!
FAILURE!

cashier checkOut!

testObjectsFactory itemSellByTheStorePrice * 2!
!Cashier methodsFor: 'checkout' stamp: 'Simon 11/6/2022 12:03:18' prior: 50555849!
checkOut

	self calculateTotal.
	self debitTotal.
	self registerSale.

	^total! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'Simon 11/6/2022 12:03:50'!
FAILURE!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:03:50'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:03:50'!
FAILURE!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 12:03:50'!
FAILURE!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'Simon 11/6/2022 12:03:51'!
FAILURE!
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'Simon 11/6/2022 12:04:38' prior: 50556192!
itemSellByTheStore
	
	^ '0'! !

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'Simon 11/6/2022 12:04:51'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'Simon 11/6/2022 12:04:51'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'Simon 11/6/2022 12:04:51'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'Simon 11/6/2022 12:04:51'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'Simon 11/6/2022 12:04:51'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'Simon 11/6/2022 12:04:51'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:04:53'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:04:53'!
FAILURE!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 12:04:53'!
FAILURE!

----SNAPSHOT----(6 November 2022 12:05:09) CuisUniversity-5510.image priorSource: 7155150!
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/6/2022 12:06:59' prior: 50556339!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	activeCarts := Dictionary new.
	checkoutCarts := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.
	salesBooks := Dictionary new.
	merchantProcessor := aMerchantProcessor .! !

Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID activeCarts catalog restInterfaceTest dictionary actualTime cartsLastUsed cartsByClient merchantProcessor salesBooks'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'Simon 11/6/2022 12:07:24'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID activeCarts catalog restInterfaceTest dictionary actualTime cartsLastUsed cartsByClient merchantProcessor salesBooks'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CreditCardTest #test01CannotCreateCreditCartWithInvalidNumer stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #CreditCardTest #test02CannotCreateCreditCartWithInvalidOwner stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:07:27'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:07:27'!
FAILURE!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 12:07:27'!
FAILURE!

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'Simon 11/6/2022 12:10:33'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID activeCarts catalog restInterfaceTest dictionary actualTime cartsLastUsed cartsByClient merchantProcessor salesBooks clientIDOfCart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/6/2022 12:10:18' prior: 50556761!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	activeCarts := Dictionary new.
	clientIDOfCart := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.
	salesBooks := Dictionary new.
	merchantProcessor := aMerchantProcessor .! !
!Sale methodsFor: 'initialization' stamp: 'Simon 11/6/2022 12:15:53'!
initializeTotal: aTotal with: aCollectionOfItems

	total := aTotal ! !

!classDefinition: #Sale category: 'TusLibros' stamp: 'Simon 11/6/2022 12:16:09'!
Object subclass: #Sale
	instanceVariableNames: 'total items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Sale methodsFor: 'initialization' stamp: 'Simon 11/6/2022 12:16:06' prior: 50556929!
initializeTotal: aTotal with: aCollectionOfItems

	total := aTotal.
	items := aCollectionOfItems.! !

!methodRemoval: Sale #initializeTotal: stamp: 'Simon 11/6/2022 12:16:13'!
initializeTotal: aTotal

	total := aTotal !
!Sale class methodsFor: 'instance creation' stamp: 'Simon 11/6/2022 12:17:00' prior: 50556172!
of: aTotal

	"should assert total is not negative or 0!!"
	| aCollectionOfItems |
	^self new initializeTotal: aTotal with: aCollectionOfItems.! !
!Sale class methodsFor: 'instance creation' stamp: 'Simon 11/6/2022 12:17:38'!
of: aTotal with: aCollectionOfItem 

	"should assert total is not negative or 0!!"
	| aCollectionOfItems |
	^self new initializeTotal: aTotal with: aCollectionOfItems.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'Simon 11/6/2022 12:17:38' prior: 50555839!
createSale

	^ Sale of: total with: 5
! !

!methodRemoval: Sale class #of: stamp: 'Simon 11/6/2022 12:17:38'!
of: aTotal

	"should assert total is not negative or 0!!"
	| aCollectionOfItems |
	^self new initializeTotal: aTotal with: aCollectionOfItems.!
!Cashier methodsFor: 'checkout - private' stamp: 'Simon 11/6/2022 12:18:45' prior: 50556968!
createSale

	^ Sale of: total with: cart listItems.
! !

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'Simon 11/6/2022 12:18:59'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'Simon 11/6/2022 12:18:59'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'Simon 11/6/2022 12:18:59'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'Simon 11/6/2022 12:18:59'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'Simon 11/6/2022 12:18:59'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'Simon 11/6/2022 12:18:59'!
PASSED!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 12:19:38' prior: 50556395!
checkOutCart: cartID payingWith: aCreditCard 

	| cart salesBook |
	cart := self obtainActiveCart: cartID .
	self canBeUsed: cartID.
	
	Cashier toCheckout: cart charging: aCreditCard  throught: merchantProcessor on:  actualTime registeringOn: (salesBook).! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 12:19:54' prior: 50557004!
checkOutCart: cartID payingWith: aCreditCard 

	| cart salesBook |
	cart := self obtainActiveCart: cartID .
	self canBeUsed: cartID.
	Cashier toCheckout: cart charging: aCreditCard  throught: merchantProcessor on:  actualTime registeringOn: (salesBook).! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 12:20:33' prior: 50556314!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	activeCarts at: lastID put: (Cart acceptingItemsOf: catalog).
	cartsLastUsed at: lastID put: actualTime .
	cartsByClient at: clientId put: (self obtainCartsIdOf: clientId).
	^lastID.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 12:21:35' prior: 50557027!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	activeCarts at: lastID put: (Cart acceptingItemsOf: catalog).
	cartsLastUsed at: lastID put: actualTime .
	clientIDOfCart at: lastID put: clientId.
	^lastID.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 12:22:12' prior: 50557016!
checkOutCart: cartID payingWith: aCreditCard 

	| cart salesBook |
	cart := self obtainActiveCart: cartID .
	self canBeUsed: cartID.
	Cashier toCheckout: cart charging: aCreditCard  throught: merchantProcessor on:  actualTime registeringOn: (salesBook).! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 12:25:39' prior: 50557052!
checkOutCart: cartID payingWith: aCreditCard 

	| cart  ownerOfCart salesByClient |
	cart := self obtainActiveCart: cartID .
	self canBeUsed: cartID.
	ownerOfCart := clientIDOfCart at: cartID.
	salesByClient := salesBooks at: ownerOfCart ifAbsent: [OrderedCollection new].
	Cashier toCheckout: cart charging: aCreditCard  throught: merchantProcessor on:  actualTime registeringOn: salesByClient.
	salesBooks at: ownerOfCart put: salesByClient.! !
!InternalRestInterface methodsFor: 'purchases' stamp: 'Simon 11/6/2022 12:26:39' prior: 50556364!
listPurchasesOf: clientId with: password 
	self assertValid: clientId with: password .
	^(salesBooks at: clientId ) inject: (Bag new) into: [ :list :sale | list addAll: sale listItems . list].! !
!Sale methodsFor: 'total' stamp: 'Simon 11/6/2022 12:27:54'!
listItems
	items.! !
!Sale methodsFor: 'total' stamp: 'Simon 11/6/2022 12:27:58' prior: 50557090!
listItems
	^items.! !
!Sale methodsFor: 'accesing' stamp: 'Simon 11/6/2022 12:28:11' prior: 50556160!
total
	
	^total! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 12:29:35' prior: 50557063!
checkOutCart: cartID payingWith: aCreditCard 

	| cart  ownerOfCart salesByClient |
	cart := self obtainActiveCart: cartID .
	self canBeUsed: cartID.
	ownerOfCart := clientIDOfCart at: cartID.
	salesByClient := salesBooks at: ownerOfCart ifAbsent: [OrderedCollection new].
	Cashier toCheckout: cart charging: aCreditCard  throught: merchantProcessor on:  actualTime registeringOn: salesByClient.
	salesBooks at: ownerOfCart put: salesByClient.
	activeCarts remove: cartID.! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 12:30:11'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 12:30:11'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 12:30:11'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 12:30:11'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 12:30:11'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 12:30:11'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 12:30:11'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 12:30:11'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 12:30:11'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 12:30:11'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 12:30:11'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:30:11'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:30:11'!
ERROR!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 12:30:11'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:30:20'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:31:30'!
ERROR!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 12:31:37' prior: 50557102!
checkOutCart: cartID payingWith: aCreditCard 

	| cart  ownerOfCart salesByClient |
	cart := self obtainActiveCart: cartID .
	self canBeUsed: cartID.
	ownerOfCart := clientIDOfCart at: cartID.
	salesByClient := salesBooks at: ownerOfCart ifAbsent: [OrderedCollection new].
	Cashier toCheckout: cart charging: aCreditCard  throught: merchantProcessor on:  actualTime registeringOn: salesByClient.
	salesBooks at: ownerOfCart put: salesByClient.
	activeCarts removeKey: cartID.! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:31:38'!
FAILURE!

salesBooks at: clientId!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:32:13'!
FAILURE!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 12:35:15' prior: 50557176!
checkOutCart: cartID payingWith: aCreditCard 

	| cart  ownerOfCart salesByClient cashier |
	cart := self obtainActiveCart: cartID .
	self canBeUsed: cartID.
	ownerOfCart := clientIDOfCart at: cartID.
	salesByClient := salesBooks at: ownerOfCart ifAbsent: [OrderedCollection new].
	cashier := Cashier toCheckout: cart charging: aCreditCard  throught: merchantProcessor on:  actualTime registeringOn: salesByClient.
	cashier checkOut.
	salesBooks at: ownerOfCart put: salesByClient.
	activeCarts removeKey: cartID.! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:35:21'!
ERROR!
!InternalRestInterface class methodsFor: 'MP double' stamp: 'Simon 11/6/2022 12:35:41'!
debit: total from: creditCard 
	self shouldBeImplemented.! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:37:12'!
ERROR!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:38:04' prior: 50555535 overrides: 16961394!
setUp 
	
	testObjectsFactory := StoreTestObjectsFactory new.
	
	time := testObjectsFactory today.
	
	restInterface := InternalRestInterface withAuthenticator: self andCatalog: testObjectsFactory defaultCatalog on: time withMp: self.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := true.
	
	debitBehavior := [ :anAmount :aCreditCard | ]
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:38:53' prior: 50557236 overrides: 16961394!
setUp 
	
	testObjectsFactory := StoreTestObjectsFactory new.
	
	time := testObjectsFactory today.
	
	restInterface := InternalRestInterface withAuthenticator: self andCatalog: testObjectsFactory defaultCatalog on: time withMp: RestInterfaceTest new.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := true.
	
	debitBehavior := [ :anAmount :aCreditCard | ]
	
	! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:38:59'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:41:57'!
ERROR!

self new!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:42:51' prior: 50557252 overrides: 16961394!
setUp 
	
	testObjectsFactory := StoreTestObjectsFactory new.
	
	time := testObjectsFactory today.
	
	restInterface := InternalRestInterface withAuthenticator: self andCatalog: testObjectsFactory defaultCatalog on: time withMp: self.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := true.
	
	debitBehavior := [ :anAmount :aCreditCard | ]
	
	! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:42:55'!
ERROR!
!Cashier methodsFor: 'checkout - private' stamp: 'Simon 11/6/2022 12:43:05' prior: 50555842!
debitTotal

	(merchantProcessor new) debit: total from: creditCard.
	! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:43:07'!
ERROR!
!Cashier methodsFor: 'checkout - private' stamp: 'Simon 11/6/2022 12:44:01' prior: 50557296!
debitTotal

	merchantProcessor debit: total from: creditCard.
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:45:33' prior: 50555675!
test12ListPurchasesAfterCheckingOutACartWithOneBook

	| cartID isbn expected |
	restInterface := InternalRestInterface withAuthenticator: self andCatalog: testObjectsFactory defaultCatalog on: time withMp: self.
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expected _ Bag new.
	expected add: isbn.
	
	restInterface checkOutCart: cartID payingWith: testObjectsFactory notExpiredCreditCard .
	
	self assert: (restInterface listPurchasesOf: clientId with: password ) equals: expected .
	
	! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:45:52'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:46:16'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:46:44'!
ERROR!

self!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:47:06' prior: 50557277 overrides: 16961394!
setUp 
	
	testObjectsFactory := StoreTestObjectsFactory new.
	
	time := testObjectsFactory today.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := true.
	
	debitBehavior := [ :anAmount :aCreditCard | ]
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:47:09' prior: 50557345 overrides: 16961394!
setUp 
	
	testObjectsFactory := StoreTestObjectsFactory new.
	
	time := testObjectsFactory today.
	
	restInterface := InternalRestInterface withAuthenticator: self andCatalog: testObjectsFactory defaultCatalog on: time withMp: self.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := true.
	
	debitBehavior := [ :anAmount :aCreditCard | ]
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:47:17' prior: 50557357 overrides: 16961394!
setUp 
	
	| myself |
	testObjectsFactory := StoreTestObjectsFactory new.
	
	time := testObjectsFactory today.
	
	myself := self.
	restInterface := InternalRestInterface withAuthenticator: self andCatalog: testObjectsFactory defaultCatalog on: time withMp: self.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := true.
	
	debitBehavior := [ :anAmount :aCreditCard | ]
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:47:26' prior: 50557373 overrides: 16961394!
setUp 
	
	| myself |
	testObjectsFactory := StoreTestObjectsFactory new.
	
	time := testObjectsFactory today.
	
	myself := self.
	restInterface := InternalRestInterface withAuthenticator: self andCatalog: testObjectsFactory defaultCatalog on: time withMp: myself.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := true.
	
	debitBehavior := [ :anAmount :aCreditCard | ]
	
	! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:47:38'!
ERROR!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:47:53' prior: 50557311!
test12ListPurchasesAfterCheckingOutACartWithOneBook

	| cartID isbn expected |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expected _ Bag new.
	expected add: isbn.
	
	restInterface checkOutCart: cartID payingWith: testObjectsFactory notExpiredCreditCard .
	
	self assert: (restInterface listPurchasesOf: clientId with: password ) equals: expected .
	
	! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:47:54'!
ERROR!
!InternalRestInterface class methodsFor: 'instance creation' stamp: 'Simon 11/6/2022 12:48:30' prior: 50556116!
withAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime withMp: aMerchantProcessor  
	^self new initializeWithAuthenticator: aRestInterfaceTest andCatalog: aDictionary on: aDateAndTime withMP: aMerchantProcessor.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:48:45' prior: 50557390 overrides: 16961394!
setUp 
	
	testObjectsFactory := StoreTestObjectsFactory new.
	
	time := testObjectsFactory today.

	restInterface := InternalRestInterface withAuthenticator: self andCatalog: testObjectsFactory defaultCatalog on: time withMp: self.
	clientId := 1234.
	password := 'ContraReDificilYSegura123'.
	
	authenticationBehavior := true.
	
	debitBehavior := [ :anAmount :aCreditCard | ]
	
	! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:48:52'!
ERROR!
!RestInterfaceTest methodsFor: 'debit behavior' stamp: 'Simon 11/6/2022 12:49:06'!
debit: total from: creditCard 
	self shouldBeImplemented.! !
!RestInterfaceTest methodsFor: 'debit behavior' stamp: 'Simon 11/6/2022 12:49:23' prior: 50557462!
debit: total from: creditCard 
	^debitBehavior value: total value: creditCard.! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:49:25'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:50:01'!
ERROR!
!Sale class methodsFor: 'instance creation' stamp: 'Simon 11/6/2022 12:50:49' prior: 50556959!
of: aTotal with: aCollectionOfItem 

	"should assert total is not negative or 0!!"

	^self new initializeTotal: aTotal with: aCollectionOfItem.! !
!Sale class methodsFor: 'instance creation' stamp: 'Simon 11/6/2022 12:50:52' prior: 50557481!
of: aTotal with: aCollectionOfItems 

	"should assert total is not negative or 0!!"

	^self new initializeTotal: aTotal with: aCollectionOfItems.! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 12:50:58'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 12:50:58'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 12:50:58'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 12:50:58'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 12:50:58'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 12:50:58'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 12:50:58'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 12:50:58'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 12:50:58'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 12:50:58'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 12:50:58'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:50:58'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:50:58'!
FAILURE!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 12:50:58'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:50:58'!
FAILURE!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 12:51:03'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 12:51:03'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 12:51:03'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 12:51:03'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 12:51:03'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 12:51:03'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 12:51:03'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 12:51:03'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 12:51:04'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 12:51:04'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 12:51:04'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:51:04'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:51:04'!
FAILURE!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 12:51:04'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:51:04'!
FAILURE!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:51:56' prior: 50555692!
test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks

	| cart1 cart2 isbn1 isbn2 expected |
	isbn1 := '1'.
	isbn2 := '2'.
	
	cart1:= restInterface createCartFor: clientId with: password.
	cart2:= restInterface createCartFor: clientId with: password.
	
	restInterface addToCart: cart1 aBook: isbn1 times: 1.
	restInterface addToCart: cart1 aBook: isbn2 times: 3.
	restInterface addToCart: cart2 aBook: isbn1 times: 1. 
	
	expected _ Bag new.
	expected add: isbn1 withOccurrences: 2.
	expected add: isbn2 withOccurrences: 3.
	
	restInterface checkOutCart: cart1 payingWith: testObjectsFactory notExpiredCreditCard .
	
	self assert: (restInterface listPurchasesOf: clientId with: password ) equals: expected .
	
	! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:52:45' prior: 50557602!
test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks

	| cart1 cart2 isbn1 isbn2 expected |
	isbn1 := '1'.
	isbn2 := '2'.
	
	cart1:= restInterface createCartFor: clientId with: password.
	cart2:= restInterface createCartFor: clientId with: password.
	
	restInterface addToCart: cart1 aBook: isbn1 times: 1.
	restInterface addToCart: cart1 aBook: isbn2 times: 3.
	restInterface addToCart: cart2 aBook: isbn1 times: 1. 
	
	expected _ Bag new.
	expected add: isbn1 withOccurrences: 2.
	expected add: isbn2 withOccurrences: 3.
	
	restInterface checkOutCart: cart1 payingWith: testObjectsFactory notExpiredCreditCard.
	restInterface checkOutCart: cart2 payingWith: testObjectsFactory notExpiredCreditCard .
	
	self assert: (restInterface listPurchasesOf: clientId with: password ) equals: expected .
	
	! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:52:46'!
FAILURE!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:53:00' prior: 50557628!
test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks

	| cart1 cart2 isbn1 isbn2 expected |
	isbn1 := '1'.
	isbn2 := '2'.
	
	cart1:= restInterface createCartFor: clientId with: password.
	cart2:= restInterface createCartFor: clientId with: password.
	
	restInterface addToCart: cart1 aBook: isbn1 times: 1.
	restInterface addToCart: cart1 aBook: isbn2 times: 3.
	restInterface addToCart: cart2 aBook: isbn1 times: 1. 
	
	expected := Bag new.
	expected add: isbn1 withOccurrences: 2.
	expected add: isbn2 withOccurrences: 3.
	
	restInterface checkOutCart: cart1 payingWith: testObjectsFactory notExpiredCreditCard.
	restInterface checkOutCart: cart2 payingWith: testObjectsFactory notExpiredCreditCard .
	
	self assert: (restInterface listPurchasesOf: clientId with: password ) equals: expected .
	
	! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:53:02'!
FAILURE!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:53:35' prior: 50557661!
test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks

	| cart1 cart2 isbn1 isbn2 expected |
	isbn1 := '1'.
	isbn2 := '2'.
	
	cart1:= restInterface createCartFor: clientId with: password.
	cart2:= restInterface createCartFor: clientId with: password.
	
	restInterface addToCart: cart1 aBook: isbn1 times: 1.
	restInterface addToCart: cart1 aBook: isbn2 times: 3.
	restInterface addToCart: cart2 aBook: isbn1 times: 1. 
	
	expected := Bag new.
	expected add: isbn1 withOccurrences: 2.
	expected add: isbn2 withOccurrences: 3.
	
	restInterface checkOutCart: cart1 payingWith: testObjectsFactory notExpiredCreditCard.
	restInterface checkOutCart: cart2 payingWith: testObjectsFactory notExpiredCreditCard .
	
	self assert: expected  equals: (restInterface listPurchasesOf: clientId with: password ).
	
	! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:53:42'!
FAILURE!

salesBooks at: clientId !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 12:54:20'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 12:54:20'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 12:54:20'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 12:54:21'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 12:54:21'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 12:54:21'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 12:54:21'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 12:54:21'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 12:54:21'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 12:54:21'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 12:54:21'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:54:21'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:54:21'!
PASSED!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 12:54:21'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 12:54:24'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 12:54:24'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 12:54:24'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 12:54:24'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 12:54:24'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 12:54:24'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 12:54:24'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 12:54:24'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 12:54:24'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 12:54:24'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 12:54:24'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 12:54:24'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:54:24'!
PASSED!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 12:54:24'!
PASSED!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:55:23'!
test14ListPurchasesAfterCheckingOutVariousCartWithManyBooks

	| cart1 cart2 isbn1 isbn2 expected |
	isbn1 := '1'.
	isbn2 := '2'.
	
	cart1:= restInterface createCartFor: clientId with: password.
	cart2:= restInterface createCartFor: clientId with: password.
	
	restInterface addToCart: cart1 aBook: isbn1 times: 1.
	restInterface addToCart: cart1 aBook: isbn2 times: 3.
	restInterface addToCart: cart2 aBook: isbn1 times: 1. 
	
	expected := Bag new.
	expected add: isbn1 withOccurrences: 2.
	expected add: isbn2 withOccurrences: 3.
	
	restInterface checkOutCart: cart1 payingWith: testObjectsFactory notExpiredCreditCard.
	restInterface checkOutCart: cart2 payingWith: testObjectsFactory notExpiredCreditCard .
	
	self assert: expected  equals: (restInterface listPurchasesOf: clientId with: password ).
	
	! !

!methodRemoval: RestInterfaceTest #test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 12:55:23'!
test12ListPurchasesAfterCheckingOutVariousCartWithManyBooks

	| cart1 cart2 isbn1 isbn2 expected |
	isbn1 := '1'.
	isbn2 := '2'.
	
	cart1:= restInterface createCartFor: clientId with: password.
	cart2:= restInterface createCartFor: clientId with: password.
	
	restInterface addToCart: cart1 aBook: isbn1 times: 1.
	restInterface addToCart: cart1 aBook: isbn2 times: 3.
	restInterface addToCart: cart2 aBook: isbn1 times: 1. 
	
	expected := Bag new.
	expected add: isbn1 withOccurrences: 2.
	expected add: isbn2 withOccurrences: 3.
	
	restInterface checkOutCart: cart1 payingWith: testObjectsFactory notExpiredCreditCard.
	restInterface checkOutCart: cart2 payingWith: testObjectsFactory notExpiredCreditCard .
	
	self assert: expected  equals: (restInterface listPurchasesOf: clientId with: password ).
	
	!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 12:58:38'!
test15CannotListPurchasesOfInvalidCartID

	self should: [restInterface checkOutCart: 1000 payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 13:01:39'!
test15CannotListPurchasesOfInvalidUser

	self should: [restInterface checkOutCart: 1000 payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.! !

!methodRemoval: RestInterfaceTest #test15CannotListPurchasesOfInvalidCartID stamp: 'Simon 11/6/2022 13:01:39'!
test15CannotListPurchasesOfInvalidCartID

	self should: [restInterface checkOutCart: 1000 payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 13:01:48'!
test15CannotListPurchasesOfInvalidLogIn

	self should: [restInterface checkOutCart: 1000 payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.! !

!methodRemoval: RestInterfaceTest #test15CannotListPurchasesOfInvalidUser stamp: 'Simon 11/6/2022 13:01:48'!
test15CannotListPurchasesOfInvalidUser

	self should: [restInterface checkOutCart: 1000 payingWith: testObjectsFactory notExpiredCreditCard ]
	raise: Error - MessageNotUnderstood
	withMessageText: restInterface class invalidCartIDErrorDescription.!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 13:02:19' prior: 50557914!
test15CannotListPurchasesOfInvalidLogIn


	self assert: 2  equals: (restInterface listPurchasesOf: clientId with: password ).! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 13:02:43' prior: 50557936!
test15CannotListPurchasesOfInvalidLogIn

	authenticationBehavior :=false.
	self should: [ restInterface listPurchasesOf: clientId with: password ]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface invalidLoginErrorDescription.! !

!testRun: #RestInterfaceTest #test15CannotListPurchasesOfInvalidLogIn stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test14ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!

!testRun: #RestInterfaceTest #test15CannotListPurchasesOfInvalidLogIn stamp: 'Simon 11/6/2022 13:02:48'!
PASSED!
!InternalRestInterface methodsFor: 'purchases' stamp: 'Simon 11/6/2022 13:03:11' prior: 50557081!
listPurchasesOf: clientId with: password 
	self assertValid: clientId with: password.
	^(salesBooks at: clientId ) inject: (Bag new) into: [ :list :sale | list addAll: sale listItems . list].! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 13:04:03'!
test15CannotUseACartAfterCheckout

	authenticationBehavior :=false.
	self should: [ restInterface listPurchasesOf: clientId with: password ]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface invalidLoginErrorDescription.! !

!methodRemoval: RestInterfaceTest #test15CannotListPurchasesOfInvalidLogIn stamp: 'Simon 11/6/2022 13:04:03'!
test15CannotListPurchasesOfInvalidLogIn

	authenticationBehavior :=false.
	self should: [ restInterface listPurchasesOf: clientId with: password ]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface invalidLoginErrorDescription.!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 13:04:40' prior: 50558019!
test15CannotUseACartAfterCheckout

	| cartID isbn expected |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expected _ Bag new.
	expected add: isbn.
	
	restInterface checkOutCart: cartID payingWith: testObjectsFactory notExpiredCreditCard .
	
	self should: [ restInterface listPurchasesOf: clientId with: password ]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface invalidCartIDErrorDescription.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:07:15' prior: 50556356!
obtainActiveCart: cartID

	^ activeCarts at: cartID ifAbsent: [
		(cartID < lastID) ifTrue: [self error: self class invalidCartIDErrorDescription]
		ifFalse: [self error: self class checkoutCartErrorDescription]
		]! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 13:07:50' prior: 50558042!
test15CannotUseACartAfterCheckout

	| cartID isbn expected |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expected _ Bag new.
	expected add: isbn.
	
	restInterface checkOutCart: cartID payingWith: testObjectsFactory notExpiredCreditCard .
	
	self should: [ restInterface addToCart: cartID aBook: isbn times: 1 ]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface invalidCartIDErrorDescription.! !

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:07:55'!
ERROR!
!InternalRestInterface class methodsFor: 'errors' stamp: 'Simon 11/6/2022 13:08:04'!
checkoutCartErrorDescription
	self shouldBeImplemented.! !
!InternalRestInterface class methodsFor: 'errors' stamp: 'Simon 11/6/2022 13:08:39' prior: 50558095!
checkoutCartErrorDescription
	^'Cannot use a cart that was already checked out.'! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 13:08:51' prior: 50558072!
test15CannotUseACartAfterCheckout

	| cartID isbn expected |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expected _ Bag new.
	expected add: isbn.
	
	restInterface checkOutCart: cartID payingWith: testObjectsFactory notExpiredCreditCard .
	
	self should: [ restInterface addToCart: cartID aBook: isbn times: 1 ]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface checkoutCartErrorDescription.! !

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:08:52'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 13:08:52'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:08:52'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 13:08:52'!
FAILURE!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 13:08:52'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 13:08:52'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 13:08:52'!
FAILURE!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 13:08:52'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 13:08:52'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 13:08:52'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 13:08:52'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 13:08:52'!
FAILURE!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 13:08:52'!
PASSED!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 13:08:52'!
PASSED!

!testRun: #RestInterfaceTest #test14ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 13:08:52'!
PASSED!

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:08:52'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 13:09:01'!
FAILURE!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:09:48' prior: 50558062!
obtainActiveCart: cartID

	^ activeCarts at: cartID ifAbsent: [
		(cartID <= lastID) ifTrue: [self error: self class invalidCartIDErrorDescription]
		ifFalse: [self error: self class checkoutCartErrorDescription]
		]! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 13:09:58'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:09:58'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 13:09:58'!
FAILURE!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 13:09:58'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 13:09:58'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 13:09:58'!
FAILURE!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 13:09:58'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 13:09:58'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 13:09:58'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 13:09:58'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 13:09:58'!
FAILURE!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 13:09:58'!
PASSED!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 13:09:58'!
PASSED!

!testRun: #RestInterfaceTest #test14ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 13:09:58'!
PASSED!

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:09:58'!
FAILURE!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:10:24' prior: 50558184!
obtainActiveCart: cartID

	^ activeCarts at: cartID ifAbsent: [
		(cartID >= lastID) ifTrue: [self error: self class invalidCartIDErrorDescription]
		ifFalse: [self error: self class checkoutCartErrorDescription]
		]! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 13:10:26'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:10:26'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 13:10:26'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 13:10:26'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 13:10:26'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 13:10:26'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 13:10:26'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 13:10:26'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 13:10:26'!
PASSED!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 13:10:26'!
PASSED!

!testRun: #RestInterfaceTest #test14ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 13:10:26'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 13:10:26'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 13:10:26'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 13:10:26'!
PASSED!

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:10:26'!
FAILURE!

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:10:26'!
FAILURE!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:10:38' prior: 50558246!
obtainActiveCart: cartID

	^ activeCarts at: cartID ifAbsent: [
		(cartID > lastID) ifTrue: [self error: self class invalidCartIDErrorDescription]
		ifFalse: [self error: self class checkoutCartErrorDescription]
		]! !

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:10:47'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!

!testRun: #RestInterfaceTest #test14ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:10:49'!
PASSED!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:11:35'!
assertValidQuantity: quantity

	^ (quantity >=1) ifFalse: [self error: self class invalidQuantityErrorDescription]! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:11:35' prior: 50556382!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := self obtainActiveCart: cartID.
	self canBeUsed: cartID .
	self assertValidQuantity: quantity.
	cart add: quantity of: bookISBN.
	activeCarts at: cartID put: cart.
	^'OK'.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 13:12:42' prior: 50558106!
test15CannotUseACartAfterCheckout

	| cartID isbn expected |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expected _ Bag new.
	expected add: isbn.
	
	restInterface checkOutCart: cartID payingWith: testObjectsFactory expiredCreditCard.
	
	self should: [ restInterface addToCart: cartID aBook: isbn times: 1 ]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface checkoutCartErrorDescription.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 13:13:14' prior: 50558394!
test15CannotUseACartAfterCheckout

	| cartID isbn expected |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expected _ Bag new.
	expected add: isbn.
	
	restInterface checkOutCart: cartID payingWith: testObjectsFactory expiredCreditCard.
	
	self should: [ restInterface addToCart: cartID aBook: isbn times: 1 ]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface invalidCartIDErrorDescription.! !
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 13:13:33' prior: 50558413!
test15CannotUseACartAfterCheckout

	| cartID isbn expected |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expected _ Bag new.
	expected add: isbn.
	
	restInterface checkOutCart: cartID payingWith: testObjectsFactory expiredCreditCard.
	
	self should: [ restInterface addToCart: cartID aBook: isbn times: 1 ]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface checkoutCartErrorDescription.! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'Simon 11/6/2022 13:19:43'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID activeCarts catalog restInterfaceTest dictionary actualTime cartsLastUsed cartsByClient merchantProcessor salesByClients clientIDOfCart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/6/2022 13:19:43' prior: 50558010!
listPurchasesOf: clientId with: password 
	self assertValid: clientId with: password.
	^(salesByClients at: clientId ) inject: (Bag new) into: [ :list :sale | list addAll: sale listItems . list].! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/6/2022 13:19:44' prior: 50556913!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	activeCarts := Dictionary new.
	clientIDOfCart := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.
	salesByClients := Dictionary new.
	merchantProcessor := aMerchantProcessor .! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/6/2022 13:19:44' prior: 50557203!
checkOutCart: cartID payingWith: aCreditCard 

	| cart  ownerOfCart salesByClient cashier |
	cart := self obtainActiveCart: cartID .
	self canBeUsed: cartID.
	ownerOfCart := clientIDOfCart at: cartID.
	salesByClient := salesByClients at: ownerOfCart ifAbsent: [OrderedCollection new].
	cashier := Cashier toCheckout: cart charging: aCreditCard  throught: merchantProcessor on:  actualTime registeringOn: salesByClient.
	cashier checkOut.
	salesByClients at: ownerOfCart put: salesByClient.
	activeCarts removeKey: cartID.! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'Simon 11/6/2022 13:20:00'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID activeCarts catalog dictionary actualTime cartsLastUsed cartsByClient merchantProcessor salesByClients clientIDOfCart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'Simon 11/6/2022 13:20:00'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticator lastID activeCarts catalog actualTime cartsLastUsed cartsByClient merchantProcessor salesByClients clientIDOfCart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 13:20:08'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:20:08'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 13:20:08'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 13:20:08'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 13:20:08'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 13:20:08'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 13:20:08'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 13:20:08'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 13:20:08'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 13:20:08'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 13:20:08'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 13:20:08'!
PASSED!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 13:20:08'!
PASSED!

!testRun: #RestInterfaceTest #test14ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 13:20:08'!
PASSED!

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:20:09'!
ERROR!

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:20:09'!
ERROR!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 13:20:35' prior: 50558432!
test15CannotUseACartAfterCheckout

	| cartID isbn expected |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expected _ Bag new.
	expected add: isbn.
	
	restInterface checkOutCart: cartID payingWith: testObjectsFactory notExpiredCreditCard.
	
	self should: [ restInterface addToCart: cartID aBook: isbn times: 1 ]
	raise: Error - MessageNotUnderstood
	withMessageText: 	InternalRestInterface checkoutCartErrorDescription.! !
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/6/2022 13:21:12' prior: 50558474!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	activeCarts := Dictionary new.
	clientIDOfCart := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	"cartsByClient := 	Dictionary new."
	salesByClients := Dictionary new.
	merchantProcessor := aMerchantProcessor .! !
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/6/2022 13:21:50' prior: 50558610!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	activeCarts := Dictionary new.
	clientIDOfCart := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	cartsByClient := 	Dictionary new.
	salesByClients := Dictionary new.
	merchantProcessor := aMerchantProcessor .! !
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/6/2022 13:22:19' prior: 50558628!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	activeCarts := Dictionary new.
	clientIDOfCart := Dictionary new.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	salesByClients := Dictionary new.
	merchantProcessor := aMerchantProcessor .! !

!methodRemoval: InternalRestInterface #obtainCartsIdOf: stamp: 'Simon 11/6/2022 13:22:21'!
obtainCartsIdOf: clientId
	^(cartsByClient at: clientId ifAbsent: [Set new]) add: lastID; yourself .!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 13:22:24'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:22:24'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 13:22:25'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 13:22:25'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 13:22:25'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 13:22:25'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 13:22:25'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 13:22:25'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 13:22:25'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 13:22:25'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 13:22:25'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 13:22:25'!
PASSED!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 13:22:25'!
PASSED!

!testRun: #RestInterfaceTest #test14ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 13:22:25'!
PASSED!

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:22:25'!
PASSED!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:23:50' prior: 50557040!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	activeCarts at: lastID put: (Cart acceptingItemsOf: catalog).
	cartsLastUsed at: lastID put: actualTime.
	clientIDOfCart at: lastID put: clientId.
	^lastID.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:24:36'!
updateTimeOf: cartID
	cartsLastUsed at: cartID put: actualTime.
! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:24:57' prior: 50558719!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	activeCarts at: lastID put: (Cart acceptingItemsOf: catalog).
	self updateTimeOf: lastID.
	clientIDOfCart at: lastID put: clientId.
	^lastID.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:25:03' prior: 50556375!
listCart: cartID 
	| cart |
	cart := self obtainActiveCart: cartID.
	self canBeUsed: cartID.
	^cart listItems.
! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:25:08' prior: 50558747!
listCart: cartID 
	| cart |
	cart := self obtainActiveCart: cartID.
	self canBeUsed: cartID.
	self updateTimeOf: cartID.
	^cart listItems.
! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:25:14' prior: 50558383!
addToCart: cartID aBook: bookISBN times: quantity 
	| cart |
	cart := self obtainActiveCart: cartID.
	self canBeUsed: cartID .
	self assertValidQuantity: quantity.
	cart add: quantity of: bookISBN.
	self updateTimeOf: cartID.
	activeCarts at: cartID put: cart.
	^'OK'.! !
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/6/2022 13:25:55' prior: 50558645!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	lastID := 0.
	actualTime := aDateAndTime.
	cartsLastUsed := Dictionary new.
	salesByClients := Dictionary new.
	activeCarts := Dictionary new.
	clientIDOfCart := Dictionary new.
	merchantProcessor := aMerchantProcessor .! !
!InternalRestInterface methodsFor: 'initialize' stamp: 'Simon 11/6/2022 13:26:04' prior: 50558774!
initializeWithAuthenticator: anAuthenticator andCatalog: interfaceCatalog  on: aDateAndTime withMP: aMerchantProcessor
	authenticator := anAuthenticator.
	catalog := interfaceCatalog.
	merchantProcessor := aMerchantProcessor .
	actualTime := aDateAndTime.
	lastID := 0.
	cartsLastUsed := Dictionary new.
	salesByClients := Dictionary new.
	activeCarts := Dictionary new.
	clientIDOfCart := Dictionary new.
	! !

Object subclass: #CartInfo
	instanceVariableNames: 'cart timeOfLastUse ownerID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartInfo category: 'TusLibros' stamp: 'Simon 11/6/2022 13:28:12'!
Object subclass: #CartInfo
	instanceVariableNames: 'cart timeOfLastUse ownerID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:29:51' prior: 50558736!
createCartFor: clientId with: password 
	self assertValid: clientId with: password.
	lastID := lastID+1.
	activeCarts at: lastID put: (CartInfo of: (Cart acceptingItemsOf: catalog) createdBy: clientId at: actualTime).
	self updateTimeOf: lastID.
	clientIDOfCart at: lastID put: clientId.
	^lastID.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:30:01' prior: 50558818!
createCartFor: clientID with: password 
	self assertValid: clientID with: password.
	lastID := lastID+1.
	activeCarts at: lastID put: (CartInfo of: (Cart acceptingItemsOf: catalog) createdBy: clientID at: actualTime).
	self updateTimeOf: lastID.
	clientIDOfCart at: lastID put: clientID.
	^lastID.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:30:41' prior: 50558831!
createCartFor: clientID with: password 
	self assertValid: clientID with: password.
	lastID := lastID+1.
	activeCarts at: lastID put: (CartInfo of: (Cart acceptingItemsOf: catalog) createdBy: clientID at: actualTime).
	self updateTimeOf: lastID.
	^lastID.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:32:03' prior: 50558492!
checkOutCart: cartID payingWith: aCreditCard 

	| cartInfo  salesByClient cashier |
	cartInfo := self obtainActiveCart: cartID .
	self canBeUsed: cartID.
	salesByClient := salesByClients at: cartInfo owner ifAbsent: [OrderedCollection new].
	cashier := Cashier toCheckout: cartInfo cart charging: aCreditCard  throught: merchantProcessor on:  actualTime registeringOn: salesByClient.
	cashier checkOut.
	salesByClients at: cartInfo owner put: salesByClient.
	activeCarts removeKey: cartID.! !
!InternalRestInterface methodsFor: 'assert' stamp: 'Simon 11/6/2022 13:33:43' prior: 50556025!
canBeUsed: aCartInfo
	 ((actualTime - aCartInfo timeOfLastUse  ) >= (self expirationTimeForCarts)) ifTrue:[self error: self class expiredCartIDErrorDescription].

! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:33:52' prior: 50558856!
checkOutCart: cartID payingWith: aCreditCard 

	| cartInfo  salesByClient cashier |
	cartInfo := self obtainActiveCart: cartID .
	self canBeUsed: cartInfo.
	salesByClient := salesByClients at: cartInfo owner ifAbsent: [OrderedCollection new].
	cashier := Cashier toCheckout: cartInfo cart charging: aCreditCard  throught: merchantProcessor on:  actualTime registeringOn: salesByClient.
	cashier checkOut.
	salesByClients at: cartInfo owner put: salesByClient.
	activeCarts removeKey: cartID.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:34:10' prior: 50558762!
addToCart: cartID aBook: bookISBN times: quantity 
	| cartInfo |
	cartInfo := self obtainActiveCart: cartID.
	self canBeUsed: cartInfo .
	self assertValidQuantity: quantity.
	cartInfo add: quantity of: bookISBN.
	self updateTimeOf: cartID.
	activeCarts at: cartID put: cartInfo.
	^'OK'.! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:35:06' prior: 50558903!
addToCart: cartID aBook: bookISBN times: quantity 
	| cartInfo |
	cartInfo := self obtainActiveCart: cartID.
	self canBeUsed: cartInfo .
	self assertValidQuantity: quantity.
	cartInfo cart add: quantity of: bookISBN.
	self updateTimeOf: cartInfo.
	activeCarts at: cartID put: cartInfo.
	^'OK'.! !
!InternalRestInterface methodsFor: 'time' stamp: 'Simon 11/6/2022 13:36:05' prior: 50558730!
updateTimeOf: cartInfo
	cartInfo timeOfLastUse: actualTime.
! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:36:20' prior: 50558754!
listCart: cartID 
	| cartInfo |
	cartInfo := self obtainActiveCart: cartID.
	self canBeUsed: cartID.
	self updateTimeOf: cartID.
	^cartInfo listItems.
! !
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:36:31' prior: 50558933!
listCart: cartID 
	| cartInfo |
	cartInfo := self obtainActiveCart: cartID.
	self canBeUsed: cartInfo.
	self updateTimeOf: cartInfo.
	^cartInfo cart listItems.
! !

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 13:36:59'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:36:59'!
ERROR!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 13:36:59'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 13:36:59'!
ERROR!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 13:36:59'!
ERROR!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 13:36:59'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 13:36:59'!
ERROR!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 13:36:59'!
ERROR!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 13:36:59'!
ERROR!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 13:36:59'!
ERROR!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 13:36:59'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 13:36:59'!
ERROR!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 13:36:59'!
ERROR!

!testRun: #RestInterfaceTest #test14ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 13:36:59'!
ERROR!

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:36:59'!
ERROR!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:37:03'!
ERROR!
!CartInfo class methodsFor: 'instance creation' stamp: 'Simon 11/6/2022 13:37:12'!
of: aCart createdBy: aSmallInteger at: aDateAndTime 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeOf: aCart createdBy: aSmallInteger at: aDateAndTime ! !
!CartInfo class methodsFor: 'instance creation' stamp: 'Simon 11/6/2022 13:37:34' prior: 50559004!
of: aCart createdBy: aClientID at: aDateAndTime 
	^self new initializeOf: aCart createdBy: aClientID at: aDateAndTime.! !

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:37:37'!
ERROR!

!classDefinition: #CartInfo category: 'TusLibros' stamp: 'Simon 11/6/2022 13:37:45'!
Object subclass: #CartInfo
	instanceVariableNames: 'cart timeOfLastUse ownerID clientID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartInfo category: 'TusLibros' stamp: 'Simon 11/6/2022 13:37:45'!
Object subclass: #CartInfo
	instanceVariableNames: 'cart timeOfLastUse ownerID clientID dateAndTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartInfo methodsFor: 'initialize' stamp: 'Simon 11/6/2022 13:37:45'!
initializeOf: aCart createdBy: aClientID at: aDateAndTime 
	self shouldBeImplemented.
	cart := aCart.
	clientID := aClientID.
	dateAndTime := aDateAndTime.! !
!CartInfo methodsFor: 'initialize' stamp: 'Simon 11/6/2022 13:37:54' prior: 50559040!
initializeOf: aCart createdBy: aClientID at: aDateAndTime 
	cart := aCart.
	clientID := aClientID.
	dateAndTime := aDateAndTime.! !

!classDefinition: #CartInfo category: 'TusLibros' stamp: 'Simon 11/6/2022 13:38:06'!
Object subclass: #CartInfo
	instanceVariableNames: 'cart timeOfLastUse ownerID clientID lastTimeOfUse'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartInfo methodsFor: 'as yet unclassified' stamp: 'Simon 11/6/2022 13:38:06' prior: 50559048!
initializeOf: aCart createdBy: aClientID at: aDateAndTime 
	cart := aCart.
	clientID := aClientID.
	lastTimeOfUse := aDateAndTime.! !

Object subclass: #CartInfo
	instanceVariableNames: 'cart ownerID clientID lastTimeOfUse'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:38:34'!
ERROR!
!InternalRestInterface methodsFor: 'carts' stamp: 'Simon 11/6/2022 13:39:10' prior: 50558844!
createCartFor: clientID with: password 
	self assertValid: clientID with: password.
	lastID := lastID+1.
	activeCarts at: lastID put: (CartInfo of: (Cart acceptingItemsOf: catalog) createdBy: clientID at: actualTime).
	^lastID.! !

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:39:12'!
ERROR!
!CartInfo methodsFor: 'accesing' stamp: 'Simon 11/6/2022 13:39:23'!
timeOfLastUse
	self shouldBeImplemented.
	^timeOfLastUse! !
!CartInfo methodsFor: 'accesing' stamp: 'Simon 11/6/2022 13:39:29' prior: 50559093!
timeOfLastUse
	^timeOfLastUse! !
!CartInfo methodsFor: 'accesing' stamp: 'Simon 11/6/2022 13:39:52' prior: 50559098!
timeOfLastUse
	^lastTimeOfUse! !
!CartInfo methodsFor: 'accesing' stamp: 'Simon 11/6/2022 13:40:03'!
lastTimeOfUse
	^lastTimeOfUse! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'Simon 11/6/2022 13:40:04' prior: 50558875!
canBeUsed: aCartInfo
	 ((actualTime - aCartInfo lastTimeOfUse  ) >= (self expirationTimeForCarts)) ifTrue:[self error: self class expiredCartIDErrorDescription].

! !

!methodRemoval: CartInfo #timeOfLastUse stamp: 'Simon 11/6/2022 13:40:04'!
timeOfLastUse
	^lastTimeOfUse!

Object subclass: #CartInfo
	instanceVariableNames: 'cart ownerID clientID lastTimeOfUse'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartInfo category: 'TusLibros' stamp: 'Simon 11/6/2022 13:40:14'!
Object subclass: #CartInfo
	instanceVariableNames: 'cart ownerID clientID lastTimeOfUse'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:40:19'!
ERROR!
!InternalRestInterface methodsFor: 'assert' stamp: 'Simon 11/6/2022 13:40:28' prior: 50559111!
canBeUsed: aCartInfo
	 ((actualTime - aCartInfo lastTimeOfUse ) >= (self expirationTimeForCarts)) ifTrue:[self error: self class expiredCartIDErrorDescription].

! !

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:40:30'!
ERROR!
!InternalRestInterface methodsFor: 'time' stamp: 'Simon 11/6/2022 13:40:41' prior: 50558928!
updateTimeOf: cartInfo
	cartInfo lastTimeOfUse: actualTime.
! !

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:40:44'!
ERROR!
!CartInfo methodsFor: 'setters' stamp: 'Simon 11/6/2022 13:40:57'!
lastTimeOfUse: actualTime 
	self shouldBeImplemented.
	lastTimeOfUse := aDateAndTime! !
!CartInfo methodsFor: 'setters' stamp: 'Simon 11/6/2022 13:41:06' prior: 50559159!
lastTimeOfUse: actualTime 
	lastTimeOfUse := actualTime! !

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:41:07'!
ERROR!
!CartInfo methodsFor: 'accesing' stamp: 'Simon 11/6/2022 13:41:12'!
cart
	self shouldBeImplemented.
	^cart! !
!CartInfo methodsFor: 'accesing' stamp: 'Simon 11/6/2022 13:41:16' prior: 50559173!
cart
	^cart! !

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:41:18'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 13:41:22'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 13:41:22'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 13:41:22'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 13:41:22'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:41:22'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 13:41:22'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 13:41:22'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 13:41:22'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 13:41:22'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 13:41:22'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 13:41:22'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 13:41:22'!
ERROR!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 13:41:22'!
ERROR!

!testRun: #RestInterfaceTest #test14ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 13:41:22'!
ERROR!

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:41:22'!
ERROR!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 13:41:27'!
ERROR!
!CartInfo methodsFor: 'accesing' stamp: 'Simon 11/6/2022 13:41:32'!
owner
	self shouldBeImplemented.! !
!CartInfo methodsFor: 'accesing' stamp: 'Simon 11/6/2022 13:41:47' prior: 50559239!
owner
	^ownerID.! !

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 13:41:48'!
ERROR!
!RestInterfaceTest methodsFor: 'tests' stamp: 'Simon 11/6/2022 13:42:19' prior: 50557410!
test12ListPurchasesAfterCheckingOutACartWithOneBook

	| cartID isbn expected |
	isbn := '1'.
	cartID:= restInterface createCartFor: clientId with: password.
	restInterface addToCart: cartID aBook: isbn times: 1.
	
	expected := Bag new.
	expected add: isbn.
	
	restInterface checkOutCart: cartID payingWith: testObjectsFactory notExpiredCreditCard .
	
	self assert: (restInterface listPurchasesOf: clientId with: password ) equals: expected .
	
	! !

activeCarts!

salesByClients!

salesByClients!

cartInfo owner!
!CartInfo methodsFor: 'initialize' stamp: 'Simon 11/6/2022 13:45:29' prior: 50559064!
initializeOf: aCart createdBy: aClientID at: aDateAndTime 
	cart := aCart.
	ownerID := aClientID.
	lastTimeOfUse := aDateAndTime.! !

Object subclass: #CartInfo
	instanceVariableNames: 'cart ownerID lastTimeOfUse'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartInfo category: 'TusLibros' stamp: 'Simon 11/6/2022 13:45:37'!
Object subclass: #CartInfo
	instanceVariableNames: 'cart ownerID lastTimeOfUse'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test14ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:45:45'!
PASSED!

!testRun: #RestInterfaceTest #test01NewCartCannotBeCreatedWithInvalidLogin stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

!testRun: #RestInterfaceTest #test02NewCartIsListedEmpty stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

!testRun: #RestInterfaceTest #test03CannotListInvalidCartID stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

!testRun: #RestInterfaceTest #test04ListCartWithOneBook stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

!testRun: #RestInterfaceTest #test05ListCartWithManyBooks stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

!testRun: #RestInterfaceTest #test06CannotAddToInvalidCartID stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

!testRun: #RestInterfaceTest #test07CannotAddInvalidQuantityBook stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

!testRun: #RestInterfaceTest #test08CannotAddToExpiredCartID stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

!testRun: #RestInterfaceTest #test09CannotListExpiredCartID stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

!testRun: #RestInterfaceTest #test10CannotCheckoutExpiredCartID stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

!testRun: #RestInterfaceTest #test11CannotCheckOutInvalidCartID stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

!testRun: #RestInterfaceTest #test12ListPurchasesAfterCheckingOutACartWithOneBook stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

!testRun: #RestInterfaceTest #test13ListPurchasesAfterCheckingOutOnlyOneCart stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

!testRun: #RestInterfaceTest #test14ListPurchasesAfterCheckingOutVariousCartWithManyBooks stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

!testRun: #RestInterfaceTest #test15CannotUseACartAfterCheckout stamp: 'Simon 11/6/2022 13:45:53'!
PASSED!

----SNAPSHOT----(6 November 2022 13:46:10) CuisUniversity-5510.image priorSource: 7203401!